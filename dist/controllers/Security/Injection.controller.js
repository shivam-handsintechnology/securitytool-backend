const _0x46116f=_0x20c1;(function(_0xc95bb5,_0x39745c){const _0x208015=_0x20c1,_0x2fa2ab=_0xc95bb5();while(!![]){try{const _0x4b0ea9=-parseInt(_0x208015(0x87))/0x1+parseInt(_0x208015(0xcd))/0x2*(-parseInt(_0x208015(0x7e))/0x3)+parseInt(_0x208015(0xbe))/0x4+parseInt(_0x208015(0x80))/0x5+parseInt(_0x208015(0xc6))/0x6*(-parseInt(_0x208015(0x98))/0x7)+parseInt(_0x208015(0xc9))/0x8*(-parseInt(_0x208015(0x9f))/0x9)+parseInt(_0x208015(0x82))/0xa;if(_0x4b0ea9===_0x39745c)break;else _0x2fa2ab['push'](_0x2fa2ab['shift']());}catch(_0x18d0ff){_0x2fa2ab['push'](_0x2fa2ab['shift']());}}}(_0x2f8f,0xd3f56));function _0x2f8f(){const _0x185d09=['user','forEach','../../utils/errorHandler','data\x20fetch\x20successfully','findOne','data','query','count','SjtjV','3pSqgju','eACdL','2486490ehOOEX','countDocuments','22361910vkulLh','map','../../utils/TestWithPlayWright/Sqlvulnurability','../../helpers/randomColorGenerator','data:\x20','747426crkiKS','message','mongoose','XLpMX','please\x20enter\x20valid\x20id','xss-injection','CWMDz','HTML','\x20\x0a\x0a','PorgY','RmNuE','keys','object','findOneAndDelete','cmd','TWxJS','ceil','650461AWrqPV','VdPaI','Remote-FiLe-Inclusion','eUWbr','ANKcT','YmbGN','gVemT','18MDBLxw','JqHTH','../../models/Project_Security_Logs','qleNh','qEkrZ','../../utils/Injectionstype.json','XML-Injection','exports','YWavc','://','slug','protocol','data\x20deleted\x20successfully','Ozawu','writeHead','Scanning\x20completed:','push','length','no-cache','SoQkv','data:','RzyiB','Scanning\x20started','stringify','VPN','log','FMhPf','XML','write','Error\x20occurred\x20while\x20scanning:','text/event-stream','3269692AkqxaM','PLEdH','plesae\x20enter\x20valid\x20id','sAWAe','Aiomh','COkfz','error','rToEZ','18WIJrmm','now','XSS','4595912Fvmfcl','html','Types','qGwbY','1015114VaIHAv','fMMGp','ABtCc','end','_id','keep-alive','Command\x20Line','https://','eoVUk','ObjectId','host','params'];_0x2f8f=function(){return _0x185d09;};return _0x2f8f();}function _0x20c1(_0x29ca0b,_0x6cabfe){const _0x2f8f0b=_0x2f8f();return _0x20c1=function(_0x20c197,_0x4fa729){_0x20c197=_0x20c197-0x70;let _0x41dd98=_0x2f8f0b[_0x20c197];return _0x41dd98;},_0x20c1(_0x29ca0b,_0x6cabfe);}const {Project_Security_Logs:Project_Security_Logs}=require(_0x46116f(0xa1)),{sendResponse:sendResponse}=require('../../utils/dataHandler'),{errorHandler:errorHandler}=require(_0x46116f(0x77)),getRandomColor=require(_0x46116f(0x85)),{default:mongoose}=require(_0x46116f(0x89)),scanSQLvulnerability=require(_0x46116f(0x84)),getAllLogs=async(_0x3ab4c7,_0x148690)=>{const _0x967873=_0x46116f,_0x54ed73={'JqHTH':function(_0x1f11ff,_0x4367f0){return _0x1f11ff>_0x4367f0;},'sZGYF':function(_0x36f566,_0x4a99a7){return _0x36f566(_0x4a99a7);},'COkfz':function(_0x191205,_0x10ca28){return _0x191205*_0x10ca28;},'ABtCc':_0x967873(0x78),'KgPBE':function(_0x2d219e,_0x11f762,_0x3e1853,_0x135704){return _0x2d219e(_0x11f762,_0x3e1853,_0x135704);}};try{const {page:_0x1eb733,limit:_0x1d2d42,question:_0x8bf116,..._0x58460a}=_0x3ab4c7[_0x967873(0x7b)];let _0x43875f={},_0x3ee928=Object[_0x967873(0x92)](_0x58460a);for(let _0x34c9bd of _0x3ee928)_0x58460a[_0x34c9bd]&&(_0x43875f[_0x34c9bd]=_0x58460a[_0x34c9bd]);_0x43875f[_0x967873(0x75)]=mongoose['Types'][_0x967873(0x72)](_0x3ab4c7[_0x967873(0x75)]['id']);const _0x103d5a=await Project_Security_Logs[_0x967873(0x81)](_0x43875f),_0x3db60b=_0x54ed73[_0x967873(0xa0)](_0x103d5a,0xa)&&parseInt(_0x1eb733)||0x1,_0x62c798=_0x54ed73['sZGYF'](parseInt,_0x1d2d42)||0xa,_0x47a003=[{'$match':_0x43875f},{'$sort':{'createdAt':-0x1}},{'$skip':_0x54ed73[_0x967873(0xc3)](_0x3db60b-0x1,_0x62c798)},{'$limit':_0x62c798}],_0x2a596d=await Project_Security_Logs['aggregate'](_0x47a003);return sendResponse(_0x148690,0xc8,_0x54ed73[_0x967873(0xcf)],{'data':_0x2a596d,'totalCount':_0x103d5a,'currentPage':_0x3db60b,'totalPages':Math[_0x967873(0x97)](_0x103d5a/_0x62c798)});}catch(_0x56ae77){return _0x54ed73['KgPBE'](errorHandler,_0x148690,0x1f4,_0x56ae77[_0x967873(0x88)]);}},getLogs=async(_0x19829b,_0x2bf615)=>{const _0x39f11c=_0x46116f,_0x5dc271={'wJsfS':function(_0x234586,_0x4fdbe1,_0x37e4ed,_0x230476,_0x2bf07b){return _0x234586(_0x4fdbe1,_0x37e4ed,_0x230476,_0x2bf07b);},'SUfch':_0x39f11c(0x78),'qleNh':_0x39f11c(0xc0),'qEkrZ':function(_0x27d17a,_0x526742,_0x4b2ecf,_0x111eaf){return _0x27d17a(_0x526742,_0x4b2ecf,_0x111eaf);}};try{const _0x282a89=_0x19829b['params']['ip'];if(_0x282a89){const _0x2e85ca=await Project_Security_Logs[_0x39f11c(0x79)]({'ip':_0x282a89});return _0x5dc271['wJsfS'](sendResponse,_0x2bf615,0xc8,_0x5dc271['SUfch'],_0x2e85ca);}return sendResponse(_0x2bf615,0x194,_0x5dc271[_0x39f11c(0xa2)]);}catch(_0x46843d){return _0x5dc271[_0x39f11c(0xa3)](errorHandler,_0x2bf615,0x1f4,_0x46843d[_0x39f11c(0x88)]);}},getLogsCount=async(_0x4dd0a2,_0xf32791)=>{const _0x138759=_0x46116f,_0x1dbc07={'PLEdH':function(_0x2e338d,_0x38205f){return _0x2e338d!==_0x38205f;},'Aiomh':_0x138759(0xb7),'rToEZ':function(_0x2230e3,_0x150985){return _0x2230e3!==_0x150985;},'TWxJS':_0x138759(0x9a),'fMMGp':function(_0x37e4fa,_0x1bbd29){return _0x37e4fa===_0x1bbd29;},'RmNuE':_0x138759(0xd3),'CWMDz':_0x138759(0x8c),'gVemT':_0x138759(0xc8),'Ozawu':_0x138759(0xca),'ANKcT':_0x138759(0xba),'tPhTo':function(_0x392d2a,_0x1b3161){return _0x392d2a(_0x1b3161);},'KRPOF':function(_0x37f86c,_0x5ad38d){return _0x37f86c===_0x5ad38d;},'eoVUk':_0x138759(0xa5),'PorgY':_0x138759(0x93),'uRKxy':'$type','ecSwG':function(_0x3b6cc0,_0x4a4139){return _0x3b6cc0>_0x4a4139;},'ZQEkO':function(_0x18806e,_0x480937,_0x19d12e,_0x11ab87,_0x15732e){return _0x18806e(_0x480937,_0x19d12e,_0x11ab87,_0x15732e);},'rLZZH':'Data\x20fetched\x20successfully','XLpMX':function(_0x820a11,_0xcc5621,_0x17159e,_0x4614aa){return _0x820a11(_0xcc5621,_0x17159e,_0x4614aa);}};try{let _0x232e07=[];console['log'](_0x1dbc07[_0x138759(0x90)],_0x4dd0a2[_0x138759(0x75)]);let _0x186124=[],_0x4f0dec={};const _0x621477=require(_0x138759(0xa4))[_0x138759(0x7a)][_0x138759(0x83)](_0x38a007=>_0x38a007[_0x138759(0xa9)]);return _0x232e07=await Project_Security_Logs['aggregate']([{'$match':{'user':new mongoose[(_0x138759(0xcb))][(_0x138759(0x72))](_0x4dd0a2[_0x138759(0x75)]['id']),'domain':_0x4dd0a2[_0x138759(0x7b)]['domain']}},{'$group':{'_id':_0x1dbc07['uRKxy'],'count':{'$sum':0x1}}}]),_0x1dbc07['ecSwG'](_0x232e07[_0x138759(0xb0)],0x0)?(_0x232e07[_0x138759(0x76)](_0x264281=>{const _0x9f0710=_0x138759;_0x4f0dec[_0x264281[_0x9f0710(0xd1)]]=_0x264281[_0x9f0710(0x7c)];}),_0x621477[_0x138759(0x76)](_0x287da1=>{const _0x4e4074=_0x138759;_0x1dbc07['PLEdH'](_0x1dbc07[_0x4e4074(0xc2)],_0x287da1)&&_0x1dbc07[_0x4e4074(0xc5)](_0x1dbc07[_0x4e4074(0x96)],_0x287da1)&&_0x186124[_0x4e4074(0xaf)]({'name':_0x1dbc07[_0x4e4074(0xce)](_0x4e4074(0x95),_0x287da1)?_0x1dbc07[_0x4e4074(0x91)]:_0x1dbc07[_0x4e4074(0x8d)]===_0x287da1?_0x1dbc07[_0x4e4074(0x9e)]:_0x1dbc07[_0x4e4074(0xac)]===_0x287da1?_0x4e4074(0x8e):_0x1dbc07[_0x4e4074(0xce)](_0x4e4074(0xa5),_0x287da1)?_0x1dbc07[_0x4e4074(0x9c)]:_0x287da1,'value':_0x4f0dec[_0x287da1]||0x0,'color':_0x1dbc07['tPhTo'](getRandomColor,_0x287da1)});})):_0x621477[_0x138759(0x76)](_0x1b420b=>{const _0xe9f46e=_0x138759;'VPN'!==_0x1b420b&&_0x1dbc07[_0xe9f46e(0xbf)](_0x1dbc07[_0xe9f46e(0x96)],_0x1b420b)&&_0x186124['push']({'name':_0x1dbc07['KRPOF'](_0x1dbc07[_0xe9f46e(0x71)],_0x1b420b)?'XML':_0x1b420b,'value':0x0,'color':getRandomColor(_0x1b420b)});}),_0x1dbc07['ZQEkO'](sendResponse,_0xf32791,0xc8,_0x1dbc07['rLZZH'],_0x186124);}catch(_0x244716){return console[_0x138759(0xb8)](_0x244716),_0x1dbc07[_0x138759(0x8a)](errorHandler,_0xf32791,0x1f4,_0x244716['message']);}},deleteLogs=async(_0xc35bdc,_0x23d283)=>{const _0xc40773=_0x46116f,_0x4cb7a0={'eUWbr':function(_0x49486f,_0x3a25a2,_0x5b9d7a,_0xb17d6b,_0x52a125){return _0x49486f(_0x3a25a2,_0x5b9d7a,_0xb17d6b,_0x52a125);},'QkAbU':_0xc40773(0xab),'SjtjV':function(_0x13df2a,_0x315a85,_0x11ae83,_0x265e60,_0x38e3c5){return _0x13df2a(_0x315a85,_0x11ae83,_0x265e60,_0x38e3c5);},'eACdL':_0xc40773(0x8b),'irWZD':function(_0x4e1b3e,_0x145c9c,_0x15018a,_0x536178){return _0x4e1b3e(_0x145c9c,_0x15018a,_0x536178);}};try{const _0x33f1ed=_0xc35bdc[_0xc40773(0x74)]['ip'],_0x4d11c9=await Project_Security_Logs[_0xc40773(0x94)]({'ip':_0x33f1ed});return _0x4d11c9?_0x4cb7a0[_0xc40773(0x9b)](sendResponse,_0x23d283,0xc8,_0x4cb7a0['QkAbU'],_0x4d11c9):_0x4cb7a0[_0xc40773(0x7d)](sendResponse,_0x23d283,0x194,_0x4cb7a0[_0xc40773(0x7f)],_0x4d11c9);}catch(_0x51eef4){return _0x4cb7a0['irWZD'](errorHandler,_0x23d283,0x1f4,_0x51eef4[_0xc40773(0x88)]);}},testVulnurability=async(_0x3337bb,_0x40835b)=>{const _0x3b0789=_0x46116f,_0x4e9358={'VdPaI':_0x3b0789(0xbd),'qGwbY':_0x3b0789(0xd2),'RzyiB':_0x3b0789(0xb1),'FMhPf':_0x3b0789(0x73),'YWavc':function(_0x440714,_0x2bc2b0,_0x51a8ca){return _0x440714(_0x2bc2b0,_0x51a8ca);},'NxLBT':_0x3b0789(0xb5),'YmbGN':function(_0x1b10e2,_0x3df4e4,_0xc2a7b3,_0x25cd7d,_0x2bea5b){return _0x1b10e2(_0x3df4e4,_0xc2a7b3,_0x25cd7d,_0x2bea5b);},'SoQkv':_0x3b0789(0xae),'sAWAe':'Scanning\x20completed','wRYDE':_0x3b0789(0xbc)};try{const _0x5043a4=_0x3337bb['query']['domain'],_0x2ab60e={'Content-Type':_0x4e9358[_0x3b0789(0x99)],'Connection':_0x4e9358[_0x3b0789(0xcc)],'Cache-Control':_0x4e9358[_0x3b0789(0xb4)]},_0x1e0f43=_0x3337bb[_0x3b0789(0xaa)]+_0x3b0789(0xa8)+_0x3337bb['get'](_0x4e9358[_0x3b0789(0xb9)])+'/api/videostream/';_0x40835b[_0x3b0789(0xad)](0xc8,_0x2ab60e);const _0x56a428=(_0x245249,_0x3a5c7e=_0x3a5c7e)=>{const _0x125cd1=_0x3b0789;_0x3a5c7e[_0x125cd1(0xbb)](_0x125cd1(0xb3)+JSON[_0x125cd1(0xb6)](_0x245249)+'\x20\x0a\x0a');};_0x4e9358[_0x3b0789(0xa7)](_0x56a428,{'message':_0x4e9358['NxLBT'],'complete':!0x1,'time':Date[_0x3b0789(0xc7)]()},_0x40835b);const _0x14b79e=await _0x4e9358[_0x3b0789(0x9d)](scanSQLvulnerability,_0x3b0789(0x70)+_0x5043a4,_0x40835b,_0x56a428,_0x1e0f43);console[_0x3b0789(0xb8)](_0x4e9358[_0x3b0789(0xb2)],_0x14b79e),_0x56a428({'message':_0x4e9358[_0x3b0789(0xc1)],'time':Date[_0x3b0789(0xc7)](),'complete':!0x0},_0x40835b),_0x40835b[_0x3b0789(0xd0)]();}catch(_0x347a90){console[_0x3b0789(0xc4)](_0x4e9358['wRYDE'],_0x347a90),_0x40835b[_0x3b0789(0xbb)](_0x3b0789(0x86)+JSON[_0x3b0789(0xb6)]({'message':_0x347a90['message'],'complete':!0x0})+_0x3b0789(0x8f)),_0x40835b[_0x3b0789(0xd0)]();}},Allogs={'getAllLogs':getAllLogs,'getLogs':getLogs,'deleteLogs':deleteLogs,'getLogsCount':getLogsCount,'testVulnurability':testVulnurability};module[_0x46116f(0xa6)]=Allogs;