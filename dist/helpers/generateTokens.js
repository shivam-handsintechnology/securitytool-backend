const _0x9549fe=_0x1724;function _0xca10(){const _0x1fb97f=['4964652mBZLTV','ACCESS_TOKEN_PRIVATE_KEY','9OPlhqN','30d','vKwBC','5JLDcDX','resolve','1861512wGQaww','134063diZJQK','REFRESH_TOKEN_PRIVATE_KEY','1305Ywejhs','10VFKJga','14m','userType','FfNLw','save','sign','env','3775610AojjGQ','4728uQnbks','findOne','1032471EMbMVC','1553864kOxnks','../models/UserToken'];_0xca10=function(){return _0x1fb97f;};return _0xca10();}function _0x1724(_0x388281,_0x2da0f6){const _0xca10fc=_0xca10();return _0x1724=function(_0x17242f,_0x56965d){_0x17242f=_0x17242f-0x7f;let _0x42ed2c=_0xca10fc[_0x17242f];return _0x42ed2c;},_0x1724(_0x388281,_0x2da0f6);}(function(_0x155153,_0x3538ee){const _0x246090=_0x1724,_0x164f7a=_0x155153();while(!![]){try{const _0x2baa3c=parseInt(_0x246090(0x8a))/0x1*(-parseInt(_0x246090(0x8d))/0x2)+-parseInt(_0x246090(0x8c))/0x3*(-parseInt(_0x246090(0x95))/0x4)+parseInt(_0x246090(0x87))/0x5*(parseInt(_0x246090(0x89))/0x6)+parseInt(_0x246090(0x82))/0x7+-parseInt(_0x246090(0x80))/0x8+parseInt(_0x246090(0x84))/0x9*(-parseInt(_0x246090(0x94))/0xa)+parseInt(_0x246090(0x7f))/0xb;if(_0x2baa3c===_0x3538ee)break;else _0x164f7a['push'](_0x164f7a['shift']());}catch(_0x123c44){_0x164f7a['push'](_0x164f7a['shift']());}}}(_0xca10,0x5e182));const jwt=require('jsonwebtoken'),UserToken=require(_0x9549fe(0x81));exports['generateTokens']=async _0x101b0d=>{const _0x2e538e=_0x9549fe,_0x113f80={'FfNLw':_0x2e538e(0x8e),'vKwBC':_0x2e538e(0x85)};try{const _0x2cac01={'_id':_0x101b0d['_id'],'roles':_0x101b0d[_0x2e538e(0x8f)]},_0x4bbc10=jwt['sign'](_0x2cac01,process[_0x2e538e(0x93)][_0x2e538e(0x83)],{'expiresIn':_0x113f80[_0x2e538e(0x90)]}),_0xe93e25=jwt[_0x2e538e(0x92)](_0x2cac01,process[_0x2e538e(0x93)][_0x2e538e(0x8b)],{'expiresIn':_0x113f80[_0x2e538e(0x86)]}),_0x5335d6=await UserToken[_0x2e538e(0x96)]({'userId':_0x101b0d['_id']});return _0x5335d6&&await _0x5335d6['remove'](),await new UserToken({'userId':_0x101b0d['_id'],'token':_0xe93e25})[_0x2e538e(0x91)](),Promise[_0x2e538e(0x88)]({'accessToken':_0x4bbc10,'refreshToken':_0xe93e25});}catch(_0x4bb990){return Promise['reject'](_0x4bb990);}};