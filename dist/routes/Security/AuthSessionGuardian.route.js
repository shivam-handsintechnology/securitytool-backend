const _0x3720c1=_0x2012;(function(_0x43cc95,_0x528c3c){const _0xa91d5=_0x2012,_0x56b02f=_0x43cc95();while(!![]){try{const _0x512122=parseInt(_0xa91d5(0x99))/0x1+parseInt(_0xa91d5(0xde))/0x2+parseInt(_0xa91d5(0xf3))/0x3*(-parseInt(_0xa91d5(0x9d))/0x4)+-parseInt(_0xa91d5(0xb6))/0x5*(-parseInt(_0xa91d5(0xad))/0x6)+-parseInt(_0xa91d5(0xb4))/0x7+-parseInt(_0xa91d5(0xa7))/0x8+parseInt(_0xa91d5(0xb5))/0x9;if(_0x512122===_0x528c3c)break;else _0x56b02f['push'](_0x56b02f['shift']());}catch(_0x3349bf){_0x56b02f['push'](_0x56b02f['shift']());}}}(_0x3944,0xc939d));const router=require(_0x3720c1(0xc3))['Router'](),{errorHandler:errorHandler}=require(_0x3720c1(0xa4)),{sessionExpireOnClose:sessionExpireOnClose,sessionTimeoutWithObject:sessionTimeoutWithObject,sessionFixationWithobject:sessionFixationWithobject,sessionHijackingWithObject:sessionHijackingWithObject,sessionTokenWithObject:sessionTokenWithObject,SessionVulnurability:SessionVulnurability}=require(_0x3720c1(0xe9)),GetFileCOntentMiddleware=require('../../middlewares/GetFileCOntentMiddleware'),{sendResponse:sendResponse}=require(_0x3720c1(0x8c)),{SecondFactorAuthBypassed:SecondFactorAuthBypassed}=require('../../utils/TestWithPlayWright/SecondFactorAuthBypassed'),{BlackPasswordValidation:BlackPasswordValidation}=require(_0x3720c1(0x86)),{checkNonHTMLContentAccessibility:checkNonHTMLContentAccessibility}=require(_0x3720c1(0x87)),SensitiveDataStoredInLocalStorageModel=require(_0x3720c1(0xc4)),SensitiveDataStoredInSessionStorageModel=require(_0x3720c1(0xcc));router[_0x3720c1(0xd8)]('/session-vulnurability',GetFileCOntentMiddleware,async(_0x35949a,_0xc49f26)=>{const _0x38d000=_0x3720c1,_0x51db5f={'nCJtG':_0x38d000(0xb2),'TKsJg':_0x38d000(0xc6),'xKthW':'JSON\x20Web\x20Token','jOJHu':_0x38d000(0x91),'mTsjx':'$containsJWT','jrjNF':function(_0xa7509d,_0xd1434f){return _0xa7509d(_0xd1434f);},'BwNHg':_0x38d000(0xca),'SzeAK':function(_0x27017a,_0x246b35){return _0x27017a>_0x246b35;},'NDCXe':'Yes','qWTKj':_0x38d000(0xbf),'XJHEu':'An\x20Adversary\x20Can\x20Hijack\x20User\x20Sessions\x20By\x20Session\x20Fixation','RrFjw':'Application\x20Is\x20Vulnerable\x20To\x20Session\x20Hijacking\x20Attack','lKsfN':_0x38d000(0xc2),'Ocqsc':function(_0x52cd83,_0x5a716c,_0x2964f4,_0x36f117){return _0x52cd83(_0x5a716c,_0x2964f4,_0x36f117);}};try{const _0x36096d={..._0x35949a['body'],..._0x35949a[_0x38d000(0xda)],..._0x35949a[_0x38d000(0x9e)]};let [_0x22b2bb]=await SensitiveDataStoredInSessionStorageModel[_0x38d000(0xdb)]([{'$match':{'appid':_0x35949a[_0x38d000(0x89)][_0x38d000(0xac)],'subdomain':_0x36096d[_0x38d000(0xc5)]}},{'$limit':0x1},{'$addFields':{'containsJWT':{'$map':{'input':_0x51db5f['nCJtG'],'as':_0x51db5f[_0x38d000(0xc8)],'in':{'$cond':{'if':{'$in':[_0x51db5f[_0x38d000(0xa5)],_0x51db5f['jOJHu']]},'then':!0x0,'else':!0x1}}}}}},{'$addFields':{'containsJWT':{'$anyElementTrue':_0x51db5f['mTsjx']}}}]),[_0x281e48]=await SensitiveDataStoredInLocalStorageModel[_0x38d000(0xdb)]([{'$match':{'appid':_0x35949a[_0x38d000(0x89)][_0x38d000(0xac)],'subdomain':_0x36096d['domain']}},{'$limit':0x1},{'$addFields':{'containsJWT':{'$map':{'input':_0x51db5f[_0x38d000(0xb7)],'as':_0x51db5f[_0x38d000(0xc8)],'in':{'$cond':{'if':{'$in':[_0x51db5f[_0x38d000(0xa5)],_0x51db5f['jOJHu']]},'then':!0x0,'else':!0x1}}}}}},{'$addFields':{'containsJWT':{'$anyElementTrue':_0x38d000(0x92)}}}]);console['log']({'sessiondata':_0x22b2bb,'localdata':_0x281e48});const _0x1dad00=_0x35949a['body'][_0x38d000(0x9a)],_0x5322c3=await _0x51db5f[_0x38d000(0xf8)](SessionVulnurability,_0x1dad00),_0x5c74cb={};_0x281e48&&_0x281e48[_0x38d000(0xd1)]||_0x22b2bb&&_0x22b2bb[_0x38d000(0xd1)]?_0x5c74cb[_0x51db5f['BwNHg']]=_0x38d000(0xdf):_0x5c74cb[_0x51db5f[_0x38d000(0xe3)]]='No',_0x5c74cb['Session\x20Does\x20Not\x20Expire\x20On\x20Closing\x20The\x20Browser']=_0x51db5f[_0x38d000(0xe6)](_0x5322c3[_0x38d000(0xab)][_0x38d000(0xe4)],0x0)?_0x51db5f['NDCXe']:_0x51db5f['qWTKj'];const _0x4906d9=_0x5322c3[_0x38d000(0xd0)][_0x38d000(0xe4)]>0x0;_0x5c74cb[_0x38d000(0xfb)]=_0x4906d9?_0x5322c3[_0x38d000(0xd0)]['toString']():_0x38d000(0xd7);const _0x160112=_0x5322c3['sessionFixation_data']['length']>0x0;_0x5c74cb[_0x51db5f[_0x38d000(0xc1)]]=_0x160112?_0x5322c3[_0x38d000(0xf2)]['toString']():_0x51db5f[_0x38d000(0x8d)];const _0x54a8f6=_0x5322c3[_0x38d000(0xa9)][_0x38d000(0xe4)]>0x0;_0x5c74cb[_0x51db5f[_0x38d000(0xd5)]]=_0x54a8f6?_0x5322c3[_0x38d000(0xa9)]['toString']():_0x51db5f[_0x38d000(0x8d)];let _0x2e6858=[];return _0x51db5f[_0x38d000(0xe6)](Object[_0x38d000(0x97)](_0x5c74cb)[_0x38d000(0xe4)],0x0)&&(_0x2e6858=Object[_0x38d000(0x97)](_0x5c74cb)[_0x38d000(0xbb)](_0x13cf83=>({[_0x13cf83]:_0x5c74cb[_0x13cf83]}))),sendResponse(_0xc49f26,0xc8,_0x51db5f[_0x38d000(0xe1)],_0x2e6858);}catch(_0x2d3249){return console['log'](_0x2d3249),_0x51db5f[_0x38d000(0xdd)](errorHandler,_0xc49f26,0x1f4,_0x2d3249['message']);}}),router[_0x3720c1(0xd8)](_0x3720c1(0x95),GetFileCOntentMiddleware,async(_0x2ac1c1,_0x16136f)=>{const _0x232215=_0x3720c1,_0x105648={'HlGMs':function(_0x4c3467,_0xbad61b){return _0x4c3467>_0xbad61b;},'VomZu':'Yes','TjfPG':'Not\x20Implemented','YuCBl':_0x232215(0x8e)};try{const _0x4cef84=_0x2ac1c1[_0x232215(0x9c)][_0x232215(0x9a)],_0x78bebb=await sessionExpireOnClose(_0x4cef84);let _0xb1ba4b=_0x78bebb&&_0x105648[_0x232215(0x93)](_0x78bebb['length'],0x0)?{'Session\x20does\x20not\x20expire\x20on\x20closing\x20the\x20browser':_0x105648['VomZu']}:{'Session\x20does\x20not\x20expire\x20on\x20closing\x20the\x20browser':_0x105648[_0x232215(0x9f)]};return sendResponse(_0x16136f,0xc8,_0x105648['YuCBl'],[_0xb1ba4b]);}catch(_0x17182e){return errorHandler(_0x16136f,0x1f4,_0x17182e[_0x232215(0xe2)]);}}),router[_0x3720c1(0xd8)](_0x3720c1(0xed),GetFileCOntentMiddleware,async(_0xcfff28,_0x5cf2e0)=>{const _0x2fcd2d=_0x3720c1,_0xfb76d0={'nYblK':function(_0x13d3db,_0x10d2d5){return _0x13d3db(_0x10d2d5);},'BGMVd':function(_0x542914,_0x562b02,_0x18f609,_0x3e5fa5,_0x350909){return _0x542914(_0x562b02,_0x18f609,_0x3e5fa5,_0x350909);},'BDKzz':'dsad','PorCe':function(_0xedb72b,_0x933f04,_0x42b166,_0xb739b6){return _0xedb72b(_0x933f04,_0x42b166,_0xb739b6);}};try{const _0xc8d9=_0xcfff28['body'][_0x2fcd2d(0x9a)],_0x3e5f05=await _0xfb76d0[_0x2fcd2d(0xb9)](sessionTimeoutWithObject,_0xc8d9);return _0xfb76d0[_0x2fcd2d(0xd9)](sendResponse,_0x5cf2e0,0xc8,_0xfb76d0[_0x2fcd2d(0xcd)],_0x3e5f05);}catch(_0x3bce48){return _0xfb76d0[_0x2fcd2d(0x88)](errorHandler,_0x5cf2e0,0x1f4,_0x3bce48[_0x2fcd2d(0xe2)]);}}),router[_0x3720c1(0xd8)](_0x3720c1(0xec),GetFileCOntentMiddleware,async(_0x431944,_0x561e79)=>{const _0x3b709f=_0x3720c1,_0x2beda7={'ZQCEg':function(_0x2d4752,_0x327bd4){return _0x2d4752(_0x327bd4);},'weFcZ':function(_0x3da1d9,_0xd71806,_0x1708aa,_0x5a6da8,_0x3e8432){return _0x3da1d9(_0xd71806,_0x1708aa,_0x5a6da8,_0x3e8432);},'bvzbY':_0x3b709f(0x8e)};try{const _0x3f2303=_0x431944[_0x3b709f(0x9c)][_0x3b709f(0x9a)],_0xf545a7=await _0x2beda7[_0x3b709f(0xc9)](sessionTokenWithObject,_0x3f2303);return _0x2beda7[_0x3b709f(0xc7)](sendResponse,_0x561e79,0xc8,_0x2beda7[_0x3b709f(0xfa)],_0xf545a7);}catch(_0x4f5cdb){return errorHandler(_0x561e79,0x1f4,_0x4f5cdb['message']);}}),router[_0x3720c1(0xd8)]('/session-fixation',GetFileCOntentMiddleware,async(_0x1307f9,_0x52cb38)=>{const _0x1c645c=_0x3720c1,_0x1bad17={'OuhAw':function(_0x454bfa,_0x445f5b){return _0x454bfa(_0x445f5b);},'JDfyz':function(_0x9898b7,_0x456b4a,_0x3df0b1,_0x1ba0bf,_0x190552){return _0x9898b7(_0x456b4a,_0x3df0b1,_0x1ba0bf,_0x190552);},'wiNyd':_0x1c645c(0x8e),'bTczA':function(_0x276a75,_0x1f6ae7,_0x474870,_0x481994){return _0x276a75(_0x1f6ae7,_0x474870,_0x481994);}};try{const _0x4145a=_0x1307f9[_0x1c645c(0x9c)]['fileContent'],_0xef6d74=await _0x1bad17[_0x1c645c(0xa8)](sessionFixationWithobject,_0x4145a);return _0x1bad17[_0x1c645c(0x90)](sendResponse,_0x52cb38,0xc8,_0x1bad17[_0x1c645c(0xf0)],_0xef6d74);}catch(_0x23b14d){return _0x1bad17[_0x1c645c(0x9b)](errorHandler,_0x52cb38,0x1f4,_0x23b14d[_0x1c645c(0xe2)]);}}),router[_0x3720c1(0xd8)]('/session-hijacking',GetFileCOntentMiddleware,async(_0x7f5e68,_0x3be99c)=>{const _0x2f18af=_0x3720c1,_0x137f98={'SGEoW':function(_0xe29fc3,_0x13a1f9){return _0xe29fc3(_0x13a1f9);},'CfusL':function(_0x3445a0,_0x501335,_0x85759e,_0xbcdb8e,_0x59538f){return _0x3445a0(_0x501335,_0x85759e,_0xbcdb8e,_0x59538f);},'AumdE':function(_0x482057,_0x525572,_0x50ff74,_0x3d8889){return _0x482057(_0x525572,_0x50ff74,_0x3d8889);}};try{const _0xefa03=_0x7f5e68[_0x2f18af(0x9c)][_0x2f18af(0x9a)],_0x1f2d34=await _0x137f98[_0x2f18af(0xd4)](sessionHijackingWithObject,_0xefa03);return _0x137f98['CfusL'](sendResponse,_0x3be99c,0xc8,'dsad',_0x1f2d34);}catch(_0x13cfe4){return _0x137f98[_0x2f18af(0xa2)](errorHandler,_0x3be99c,0x1f4,_0x13cfe4[_0x2f18af(0xe2)]);}}),router[_0x3720c1(0xd8)](_0x3720c1(0xea),async(_0x81e406,_0x4b5d64)=>{const _0x6f250d=_0x3720c1,_0x5bc590={'uuEQi':_0x6f250d(0xdc),'cfXPc':function(_0x32c991,_0x33df4f,_0x3e75fa){return _0x32c991(_0x33df4f,_0x3e75fa);},'XZabl':_0x6f250d(0xc0),'UjMDp':function(_0x2be466,_0x2dfb80,_0x2741f4,_0x382f23){return _0x2be466(_0x2dfb80,_0x2741f4,_0x382f23);},'yiZPU':_0x6f250d(0xf9),'iIItV':_0x6f250d(0x8a),'VKArx':'Error\x20occurred\x20while\x20scanning:'};try{const _0x50799a=_0x81e406[_0x6f250d(0xda)][_0x6f250d(0xc5)],_0x5b1c18={'Content-Type':_0x6f250d(0xee),'Connection':'keep-alive','Cache-Control':_0x5bc590[_0x6f250d(0xa1)]};_0x4b5d64[_0x6f250d(0xbe)](0xc8,_0x5b1c18);const _0x1dfa98=(_0x563a0a,_0x48bba7=_0x48bba7)=>{const _0x1fb708=_0x6f250d;_0x48bba7['write'](_0x1fb708(0xd2)+JSON[_0x1fb708(0xf5)](_0x563a0a)+'\x20\x0a\x0a');};_0x5bc590['cfXPc'](_0x1dfa98,{'message':_0x5bc590[_0x6f250d(0xaa)],'time':Date[_0x6f250d(0xcf)]()},_0x4b5d64);const _0x7f77cf=await _0x5bc590[_0x6f250d(0xaf)](checkNonHTMLContentAccessibility,'https://'+_0x50799a,_0x4b5d64,_0x1dfa98);console['log'](_0x5bc590[_0x6f250d(0xb0)],_0x7f77cf),_0x1dfa98({'message':_0x5bc590[_0x6f250d(0xae)],'time':Date['now'](),'complete':!0x0},_0x4b5d64),_0x4b5d64[_0x6f250d(0xf7)]();}catch(_0x2ad1f6){console[_0x6f250d(0xe5)](_0x5bc590[_0x6f250d(0xf1)],_0x2ad1f6),_0x4b5d64[_0x6f250d(0xeb)](_0x6f250d(0xce)+JSON[_0x6f250d(0xf5)]({'message':_0x2ad1f6[_0x6f250d(0xe2)]})+_0x6f250d(0xf6)),_0x4b5d64[_0x6f250d(0xf7)]();}}),router['get']('/SecondFactorAuth',async(_0x48cf04,_0x576d66)=>{const _0x51231d=_0x3720c1,_0x39220a={'yWjrY':_0x51231d(0xee),'zcTxW':_0x51231d(0xb3),'Asslz':_0x51231d(0xdc),'QTDGb':function(_0xf4896c,_0x55aedd,_0xd547db){return _0xf4896c(_0x55aedd,_0xd547db);},'HqeTG':'Scanning\x20started','OsOZv':function(_0x40f04d,_0x3f119b,_0x5ee167,_0x2850ca){return _0x40f04d(_0x3f119b,_0x5ee167,_0x2850ca);},'kvQOC':_0x51231d(0xf9),'FsSmR':_0x51231d(0x8a),'uMpvU':_0x51231d(0x98)};try{const _0x4ab024=_0x48cf04[_0x51231d(0xda)]['domain'],_0x1984ed={'Content-Type':_0x39220a[_0x51231d(0xf4)],'Connection':_0x39220a['zcTxW'],'Cache-Control':_0x39220a[_0x51231d(0xb1)]};_0x576d66[_0x51231d(0xbe)](0xc8,_0x1984ed);const _0x15e06e=(_0x47c014,_0x4ae810=_0x4ae810)=>{const _0x3cb1cf=_0x51231d;_0x4ae810['write'](_0x3cb1cf(0xd2)+JSON[_0x3cb1cf(0xf5)](_0x47c014)+_0x3cb1cf(0xf6));};_0x39220a[_0x51231d(0xe8)](_0x15e06e,{'message':_0x39220a[_0x51231d(0xa0)],'complete':!0x1,'time':Date['now']()},_0x576d66);const _0x5adeb1=await _0x39220a[_0x51231d(0x8b)](SecondFactorAuthBypassed,_0x51231d(0xef)+_0x4ab024,_0x576d66,_0x15e06e);console[_0x51231d(0xa6)](_0x39220a[_0x51231d(0xe7)],_0x5adeb1),_0x15e06e({'message':_0x39220a[_0x51231d(0x8f)],'time':Date[_0x51231d(0xcf)](),'complete':!0x0},_0x576d66),_0x576d66[_0x51231d(0xf7)]();}catch(_0x5091c7){console[_0x51231d(0xe5)](_0x39220a[_0x51231d(0xbc)],_0x5091c7),_0x576d66[_0x51231d(0xeb)]('data:\x20'+JSON[_0x51231d(0xf5)]({'message':_0x5091c7[_0x51231d(0xe2)],'complete':!0x0})+_0x51231d(0xf6)),_0x576d66['end']();}}),router[_0x3720c1(0xd8)](_0x3720c1(0xd6),async(_0x3ee40d,_0xc25ace)=>{const _0x75a89f=_0x3720c1,_0x2f256d={'fCJFf':_0x75a89f(0xdc),'xdQjz':function(_0x25facf,_0x1b136e,_0x1286e1){return _0x25facf(_0x1b136e,_0x1286e1);},'iqAkP':'Scanning\x20started','xkjsk':function(_0x56d221,_0x2bf1a6,_0x405b9e,_0x79476d,_0x570128){return _0x56d221(_0x2bf1a6,_0x405b9e,_0x79476d,_0x570128);},'JvUAd':_0x75a89f(0xf9),'NIIlF':_0x75a89f(0x8a),'UwCcB':_0x75a89f(0x98)};try{const _0x474f0d=_0x3ee40d[_0x75a89f(0xda)][_0x75a89f(0xc5)],_0x5bf206={'Content-Type':_0x75a89f(0xee),'Connection':_0x75a89f(0xb3),'Cache-Control':_0x2f256d[_0x75a89f(0xba)]},_0x5d16aa=_0x3ee40d[_0x75a89f(0xd3)]+_0x75a89f(0xe0)+_0x3ee40d[_0x75a89f(0xd8)]('host')+'/api/videostream/';_0xc25ace['writeHead'](0xc8,_0x5bf206);const _0x443bb2=(_0x5d61de,_0x4e392b=_0x4e392b)=>{const _0x30273b=_0x75a89f;_0x4e392b[_0x30273b(0xeb)](_0x30273b(0xd2)+JSON[_0x30273b(0xf5)](_0x5d61de)+_0x30273b(0xf6));};_0x2f256d['xdQjz'](_0x443bb2,{'message':_0x2f256d[_0x75a89f(0xa3)],'complete':!0x1,'time':Date[_0x75a89f(0xcf)]()},_0xc25ace);const _0x1b48fc=await _0x2f256d[_0x75a89f(0xbd)](BlackPasswordValidation,'https://'+_0x474f0d,_0xc25ace,_0x443bb2,_0x5d16aa);console[_0x75a89f(0xa6)](_0x2f256d['JvUAd'],_0x1b48fc),_0x2f256d[_0x75a89f(0x94)](_0x443bb2,{'message':_0x2f256d[_0x75a89f(0xcb)],'time':Date['now'](),'complete':!0x0},_0xc25ace),_0xc25ace[_0x75a89f(0xf7)]();}catch(_0x2a2d43){console[_0x75a89f(0xe5)](_0x2f256d[_0x75a89f(0xb8)],_0x2a2d43),_0xc25ace['write'](_0x75a89f(0xce)+JSON[_0x75a89f(0xf5)]({'message':_0x2a2d43[_0x75a89f(0xe2)],'complete':!0x0})+_0x75a89f(0xf6)),_0xc25ace['end']();}}),module[_0x3720c1(0x96)]=router;function _0x2012(_0x7b274f,_0x466ea3){const _0x3944f2=_0x3944();return _0x2012=function(_0x201224,_0x1e585d){_0x201224=_0x201224-0x86;let _0x26b516=_0x3944f2[_0x201224];return _0x26b516;},_0x2012(_0x7b274f,_0x466ea3);}function _0x3944(){const _0x4e8bd2=['sessionHijacking_data','XZabl','sessionExpireOnClose_data','appid','6gODrkx','iIItV','UjMDp','yiZPU','Asslz','$data','keep-alive','2983848mePmum','12400614DVoIHl','2960715nfvlFf','nCJtG','UwCcB','nYblK','fCJFf','map','uMpvU','xkjsk','writeHead','Not\x20Implemented','Scanning\x20started','XJHEu','fetch','express','../../models/Security/SensitiveDataStoredInLocalStorage.model','domain','dataItem','weFcZ','TKsJg','ZQCEg','Session\x20Token\x20Being\x20Passed\x20In\x20Other\x20Areas\x20Apart\x20From\x20Cookies','NIIlF','../../models/Security/SensitiveDataStoredInSessionStorage.model','BDKzz','data:\x20','now','sessionTimeout_data','containsJWT','data:','protocol','SGEoW','RrFjw','/blankpasswordandusername','Not\x20IMplemented','get','BGMVd','query','aggregate','no-cache','Ocqsc','2255432gSybVW','Yes','://','lKsfN','message','BwNHg','length','error','SzeAK','kvQOC','QTDGb','../../helpers/SessionVulnurabiltyChecker','/non-html-content-accessability','write','/session-token','/session-timeout','text/event-stream','https://','wiNyd','VKArx','sessionFixation_data','33EOKSol','yWjrY','stringify','\x20\x0a\x0a','end','jrjNF','Scanning\x20completed:','bvzbY','Session\x20Time-Out\x20Is\x20High\x20(Or)\x20Not\x20Implemented','../../utils/TestWithPlayWright/BlacnkPasswordANdUserName','../../utils/TestWithPlayWright/checkNonHtmlAccccesability','PorCe','user','Scanning\x20completed','OsOZv','../../utils/dataHandler','qWTKj','dsad','FsSmR','JDfyz','$$dataItem.value','$containsJWT','HlGMs','xdQjz','/session-expire-on-close','exports','keys','Error\x20occurred\x20while\x20scanning:','25511SEwYzs','fileContent','bTczA','body','381968qGewuO','params','TjfPG','HqeTG','uuEQi','AumdE','iqAkP','../../utils/errorHandler','xKthW','log','6578552LTxXDi','OuhAw'];_0x3944=function(){return _0x4e8bd2;};return _0x3944();}