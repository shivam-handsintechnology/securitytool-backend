const _0x1d4809=_0x4f04;function _0x4f04(_0x5dc1c6,_0x2742fa){const _0x332b10=_0x332b();return _0x4f04=function(_0x4f04df,_0x50992e){_0x4f04df=_0x4f04df-0x14b;let _0x53908a=_0x332b10[_0x4f04df];return _0x53908a;},_0x4f04(_0x5dc1c6,_0x2742fa);}function _0x332b(){const _0x1a6e67=['233494ectVdJ','398830gIHBOP','iFrame','fvlGL','uPlWR','UKZvR','lSbrf','../../utils/errorHandler','../../models/Project_Security_Logs','Types','../../utils/dataHandler','2196565tgIfll','xssInjection','676398IEnEmY','aggregate','4543170iwVNxX','oAeiw','message','count','kIBlQ','ZRwGe','CSS','ZvNEs','139468EFLsim','3xHxksl','css','1576keOuwD','IFrame','length','ObjectId','xss-injection','234kRwJOW','mongoose','35XriQGC'];_0x332b=function(){return _0x1a6e67;};return _0x332b();}(function(_0x2346de,_0x2241f6){const _0x11f58e=_0x4f04,_0x5cc53d=_0x2346de();while(!![]){try{const _0x443b19=-parseInt(_0x11f58e(0x164))/0x1+-parseInt(_0x11f58e(0x165))/0x2*(-parseInt(_0x11f58e(0x15a))/0x3)+parseInt(_0x11f58e(0x159))/0x4*(parseInt(_0x11f58e(0x163))/0x5)+parseInt(_0x11f58e(0x14f))/0x6+parseInt(_0x11f58e(0x14d))/0x7+parseInt(_0x11f58e(0x15c))/0x8*(-parseInt(_0x11f58e(0x161))/0x9)+-parseInt(_0x11f58e(0x151))/0xa;if(_0x443b19===_0x2241f6)break;else _0x5cc53d['push'](_0x5cc53d['shift']());}catch(_0x38130e){_0x5cc53d['push'](_0x5cc53d['shift']());}}}(_0x332b,0x2b3b7));const {Project_Security_Logs:Project_Security_Logs}=require(_0x1d4809(0x16c)),{sendResponse:sendResponse}=require(_0x1d4809(0x14c)),{errorHandler:errorHandler}=require(_0x1d4809(0x16b)),mongoose=require(_0x1d4809(0x162));module['exports']={'XSSvulnurability':async(_0x54ddab,_0x16420a)=>{const _0x39e739=_0x1d4809,_0x46bec8={'bItut':_0x39e739(0x160),'lSbrf':_0x39e739(0x157),'ZvNEs':_0x39e739(0x154),'kIBlQ':function(_0x31c863,_0x9ced72){return _0x31c863>_0x9ced72;},'ZRwGe':'Yes','fvlGL':function(_0x5f584b,_0x5e4405){return _0x5f584b>_0x5e4405;},'UKZvR':function(_0x3bcf69,_0x3cd569){return _0x3bcf69>_0x3cd569;},'oAeiw':function(_0x455ead,_0x4055f9){return _0x455ead>_0x4055f9;},'uPlWR':function(_0x45c862,_0x558830,_0x5f3dce,_0x58fda7,_0xedfb35){return _0x45c862(_0x558830,_0x5f3dce,_0x58fda7,_0xedfb35);}};try{const _0x173ca3=[{'$match':{'user':new mongoose[(_0x39e739(0x14b))][(_0x39e739(0x15f))](_0x54ddab['user']['id'])}},{'$facet':{'xssInjection':[{'$match':{'type':_0x46bec8['bItut']}},{'$count':'count'}],'css':[{'$match':{'type':_0x46bec8[_0x39e739(0x16a)]}},{'$count':_0x46bec8[_0x39e739(0x158)]}],'iFrame':[{'$match':{'type':_0x39e739(0x15d)}},{'$count':_0x46bec8[_0x39e739(0x158)]}]}},{'$limit':0x1}],_0x2b45e2=await Project_Security_Logs[_0x39e739(0x150)](_0x173ca3);let _0x3ec0bc={'Application\x20is\x20vulnerable\x20to\x20Cross\x20Site\x20Scripting\x20attack':_0x46bec8['kIBlQ'](_0x2b45e2[_0x39e739(0x15e)],0x0)&&_0x46bec8[_0x39e739(0x155)](_0x2b45e2[0x0][_0x39e739(0x14e)]['length'],0x0)?_0x46bec8[_0x39e739(0x156)]:'No','Application\x20is\x20vulnerable\x20to\x20stored\x20Cross\x20Site\x20Scripting\x20attack':_0x46bec8[_0x39e739(0x167)](_0x2b45e2[_0x39e739(0x15e)],0x0)&&_0x46bec8[_0x39e739(0x169)](_0x2b45e2[0x0][_0x39e739(0x14e)][_0x39e739(0x15e)],0x0)?_0x46bec8['ZRwGe']:'No','Is\x20XSS\x20possible\x20via\x20CSS\x20injection\x20?':_0x46bec8['fvlGL'](_0x2b45e2[_0x39e739(0x15e)],0x0)&&_0x2b45e2[0x0][_0x39e739(0x15b)][_0x39e739(0x15e)]>0x0?_0x46bec8[_0x39e739(0x156)]:'No','Application\x20is\x20vulnerable\x20to\x20cross\x20frame\x20scripting':_0x46bec8[_0x39e739(0x155)](_0x2b45e2[_0x39e739(0x15e)],0x0)&&_0x46bec8[_0x39e739(0x152)](_0x2b45e2[0x0][_0x39e739(0x166)]['length'],0x0)?_0x46bec8[_0x39e739(0x156)]:'No'};return _0x46bec8[_0x39e739(0x168)](sendResponse,_0x16420a,0xc8,'Data\x20fetched\x20successfully',_0x3ec0bc);}catch(_0x28df85){return errorHandler(_0x16420a,0x1f4,_0x28df85[_0x39e739(0x153)]);}}};