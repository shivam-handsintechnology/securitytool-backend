const _0x805b15=_0x1f0b;function _0x40b8(){const _0x1fa060=['jlIQX','fGnxx','CSS','IFrame','133130PWGeqy','ObjectId','Yes','count','1372510GDPHTk','7701880FZGQsO','QjuLK','../../utils/errorHandler','length','jibis','../../utils/dataHandler','598917afKUxA','20KOKrRf','3827180pSYype','message','LmBGb','xss-injection','../../models/Project_Security_Logs','css','mongoose','9csRbgO','xssInjection','Data\x20fetched\x20successfully','vtLAl','7903HzJkrH','1398436fLSZGO','3198xaPaDo'];_0x40b8=function(){return _0x1fa060;};return _0x40b8();}function _0x1f0b(_0x450820,_0x1ef72f){const _0x40b8f4=_0x40b8();return _0x1f0b=function(_0x1f0b07,_0x9b9e57){_0x1f0b07=_0x1f0b07-0x175;let _0x1cdb47=_0x40b8f4[_0x1f0b07];return _0x1cdb47;},_0x1f0b(_0x450820,_0x1ef72f);}(function(_0x42f502,_0x1716cf){const _0x220417=_0x1f0b,_0x2e0861=_0x42f502();while(!![]){try{const _0x3517be=-parseInt(_0x220417(0x180))/0x1+parseInt(_0x220417(0x17a))/0x2+-parseInt(_0x220417(0x18b))/0x3*(-parseInt(_0x220417(0x18c))/0x4)+-parseInt(_0x220417(0x18d))/0x5+-parseInt(_0x220417(0x17b))/0x6*(-parseInt(_0x220417(0x179))/0x7)+-parseInt(_0x220417(0x185))/0x8+-parseInt(_0x220417(0x175))/0x9*(-parseInt(_0x220417(0x184))/0xa);if(_0x3517be===_0x1716cf)break;else _0x2e0861['push'](_0x2e0861['shift']());}catch(_0x3742f4){_0x2e0861['push'](_0x2e0861['shift']());}}}(_0x40b8,0x8c690));const {Project_Security_Logs:Project_Security_Logs}=require(_0x805b15(0x191)),{sendResponse:sendResponse}=require(_0x805b15(0x18a)),{errorHandler:errorHandler}=require(_0x805b15(0x187)),mongoose=require(_0x805b15(0x193));module['exports']={'XSSvulnurability':async(_0xeb46ef,_0x23c8b2)=>{const _0x4b7824=_0x805b15,_0x3d9fdc={'wVsFZ':_0x4b7824(0x190),'cRVcw':_0x4b7824(0x183),'eavub':_0x4b7824(0x17e),'CgBpN':_0x4b7824(0x17f),'LmBGb':function(_0x486547,_0x24d5d4){return _0x486547>_0x24d5d4;},'vtLAl':function(_0x54ea4e,_0x2b8e69){return _0x54ea4e>_0x2b8e69;},'fGnxx':_0x4b7824(0x182),'jibis':function(_0xc9117,_0x4374ca){return _0xc9117>_0x4374ca;},'jlIQX':_0x4b7824(0x177),'QjuLK':function(_0x398331,_0x2ec9e2,_0x4cc5ee,_0x4c769d){return _0x398331(_0x2ec9e2,_0x4cc5ee,_0x4c769d);}};try{const _0x4ee7b7=[{'$match':{'user':new mongoose['Types'][(_0x4b7824(0x181))](_0xeb46ef['user']['id'])}},{'$facet':{'xssInjection':[{'$match':{'type':_0x3d9fdc['wVsFZ']}},{'$count':_0x3d9fdc['cRVcw']}],'css':[{'$match':{'type':_0x3d9fdc['eavub']}},{'$count':_0x3d9fdc['cRVcw']}],'iFrame':[{'$match':{'type':_0x3d9fdc['CgBpN']}},{'$count':_0x4b7824(0x183)}]}},{'$limit':0x1}],_0x1296c7=await Project_Security_Logs['aggregate'](_0x4ee7b7);let _0x207ebb={'Application\x20is\x20vulnerable\x20to\x20Cross\x20Site\x20Scripting\x20attack':_0x1296c7[_0x4b7824(0x188)]>0x0&&_0x3d9fdc[_0x4b7824(0x18f)](_0x1296c7[0x0][_0x4b7824(0x176)][_0x4b7824(0x188)],0x0)?'Yes':'No','Application\x20is\x20vulnerable\x20to\x20stored\x20Cross\x20Site\x20Scripting\x20attack':_0x3d9fdc[_0x4b7824(0x178)](_0x1296c7[_0x4b7824(0x188)],0x0)&&_0x1296c7[0x0]['xssInjection'][_0x4b7824(0x188)]>0x0?_0x3d9fdc[_0x4b7824(0x17d)]:'No','Is\x20XSS\x20possible\x20via\x20CSS\x20injection\x20?':_0x1296c7['length']>0x0&&_0x1296c7[0x0][_0x4b7824(0x192)][_0x4b7824(0x188)]>0x0?_0x3d9fdc[_0x4b7824(0x17d)]:'No','Application\x20is\x20vulnerable\x20to\x20cross\x20frame\x20scripting':_0x3d9fdc[_0x4b7824(0x18f)](_0x1296c7[_0x4b7824(0x188)],0x0)&&_0x3d9fdc[_0x4b7824(0x189)](_0x1296c7[0x0]['iFrame'][_0x4b7824(0x188)],0x0)?_0x3d9fdc[_0x4b7824(0x17d)]:'No'};return sendResponse(_0x23c8b2,0xc8,_0x3d9fdc[_0x4b7824(0x17c)],_0x207ebb);}catch(_0xa1a44){return _0x3d9fdc[_0x4b7824(0x186)](errorHandler,_0x23c8b2,0x1f4,_0xa1a44[_0x4b7824(0x18e)]);}}};