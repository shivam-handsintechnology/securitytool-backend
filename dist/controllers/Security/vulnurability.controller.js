const _0x3a2854=_0x3d24;(function(_0x293c3c,_0x45e308){const _0x5561cc=_0x3d24,_0x1fabfa=_0x293c3c();while(!![]){try{const _0x195632=parseInt(_0x5561cc(0x200))/0x1*(parseInt(_0x5561cc(0x219))/0x2)+-parseInt(_0x5561cc(0x250))/0x3*(-parseInt(_0x5561cc(0x201))/0x4)+-parseInt(_0x5561cc(0x229))/0x5*(-parseInt(_0x5561cc(0x1f5))/0x6)+parseInt(_0x5561cc(0x22c))/0x7*(-parseInt(_0x5561cc(0x20b))/0x8)+-parseInt(_0x5561cc(0x22f))/0x9+-parseInt(_0x5561cc(0x1ee))/0xa+parseInt(_0x5561cc(0x238))/0xb;if(_0x195632===_0x45e308)break;else _0x1fabfa['push'](_0x1fabfa['shift']());}catch(_0x2c7422){_0x1fabfa['push'](_0x1fabfa['shift']());}}}(_0x1b92,0x818d7));function _0x3d24(_0x5ed048,_0x877588){const _0x1b9238=_0x1b92();return _0x3d24=function(_0x3d243d,_0xccbbc8){_0x3d243d=_0x3d243d-0x1ed;let _0x2b3b1d=_0x1b9238[_0x3d243d];return _0x2b3b1d;},_0x3d24(_0x5ed048,_0x877588);}const {Project_Security_Logs:Project_Security_Logs}=require(_0x3a2854(0x1f0)),{CrticalInformationInurl:CrticalInformationInurl}=require('../../models/sensitivekeywordsModel'),{checkForSensitiveInfoInBody:checkForSensitiveInfoInBody,CheckPasswordKeyText:CheckPasswordKeyText,CheckAllDataIsEncrypted:CheckAllDataIsEncrypted}=require(_0x3a2854(0x222)),{sensitivedata:sensitivedata,passwordkeys:passwordkeys}=require('../../sensitive/availableapikeys'),{sendResponse:sendResponse}=require(_0x3a2854(0x239)),{errorHandler:errorHandler}=require(_0x3a2854(0x227)),{PasswordValidateModel:PasswordValidateModel}=require(_0x3a2854(0x254)),{ServerDataInPlaintextModel:ServerDataInPlaintextModel}=require(_0x3a2854(0x253)),User=require(_0x3a2854(0x258)),{VpnResponse:VpnResponse}=require(_0x3a2854(0x21d));module['exports']={'createuserdetails':async(_0x1c238d,_0x1e3822)=>{const _0x2f1fda=_0x3a2854;try{let {UserRawData:_0x1ffcbc,domain:_0x23fd7f,appid:_0x3b9c30}=_0x1c238d[_0x2f1fda(0x20c)];return await Project_Security_Logs[_0x2f1fda(0x221)]({'user':_0x1c238d[_0x2f1fda(0x1f6)][_0x2f1fda(0x235)],'ip':_0x1ffcbc['ip'],'domain':_0x23fd7f,'appid':_0x3b9c30})?await Project_Security_Logs[_0x2f1fda(0x232)]({'user':_0x1c238d[_0x2f1fda(0x1f6)]['_id'],'ip':_0x1ffcbc['ip'],'domain':_0x23fd7f,'appid':_0x3b9c30},{'$set':_0x1ffcbc}):await Project_Security_Logs[_0x2f1fda(0x23f)]({'user':_0x1c238d['user'][_0x2f1fda(0x235)],'domain':_0x23fd7f,'appid':_0x3b9c30,..._0x1ffcbc}),sendResponse(_0x1e3822,0xc8,'fetch','ok');}catch(_0xe02815){return errorHandler(_0x1e3822,0x1f4,_0xe02815[_0x2f1fda(0x210)]);}},'createuserdetailsfromclient':async(_0x5786e1,_0x333a58)=>{const _0x453f81=_0x3a2854,_0x3ff71e={'SLXQa':_0x453f81(0x24f),'BxbBJ':_0x453f81(0x240),'hxemU':_0x453f81(0x205),'MoFDJ':_0x453f81(0x20e),'TrAYQ':_0x453f81(0x247),'eHwnh':_0x453f81(0x1fc),'lKyUc':'December','xyFmR':_0x453f81(0x256),'XDkKu':'user-agent','LXrFa':function(_0x4e8395,_0x269bba,_0x2380c5,_0x2b4635){return _0x4e8395(_0x269bba,_0x2380c5,_0x2b4635);},'HFCiy':_0x453f81(0x212),'weLfK':function(_0x423ded,_0xd9b6cc){return _0x423ded+_0xd9b6cc;},'GjqwB':function(_0x5205c0,_0x3a4c9b){return _0x5205c0+_0x3a4c9b;},'iCtFR':function(_0x5b8e3d,_0x59a90b,_0x669088,_0x43fbea,_0x54f631){return _0x5b8e3d(_0x59a90b,_0x669088,_0x43fbea,_0x54f631);},'wWZXZ':'fetch'};try{const _0x3fa510=[_0x3ff71e[_0x453f81(0x23c)],_0x453f81(0x252),_0x453f81(0x215),_0x453f81(0x211),_0x3ff71e[_0x453f81(0x206)],_0x3ff71e['hxemU'],_0x453f81(0x249),_0x3ff71e[_0x453f81(0x20f)],_0x3ff71e[_0x453f81(0x22b)],_0x453f81(0x242),_0x3ff71e['eHwnh'],_0x3ff71e['lKyUc']],_0x3b40cc=new Date();let {data:_0x233286,hostname:_0x5bdc78,appid:_0x3f3996}=_0x5786e1[_0x453f81(0x20c)],_0x9bb308=_0x5786e1[_0x453f81(0x1f4)][_0x3ff71e[_0x453f81(0x1fb)]]||_0x5786e1[_0x453f81(0x208)][_0x453f81(0x21a)];const _0x26d4a2=_0x5786e1[_0x453f81(0x1f4)][_0x3ff71e['XDkKu']];let _0x3158a5=await User[_0x453f81(0x221)]({'appid':_0x3f3996});if(!_0x3158a5)return _0x3ff71e[_0x453f81(0x218)](errorHandler,_0x333a58,0x190,_0x3ff71e[_0x453f81(0x228)]);let _0xe48886={'useragent':_0x26d4a2,'ip':_0x9bb308,'date':_0x3ff71e[_0x453f81(0x1f8)](_0x3ff71e[_0x453f81(0x20d)](_0x3ff71e['weLfK'](_0x3b40cc[_0x453f81(0x1fe)](),'\x20'),_0x3fa510[_0x3b40cc['getMonth']()]),'\x20')+_0x3b40cc[_0x453f81(0x245)](),'time':_0x3b40cc[_0x453f81(0x1ed)]()};return _0x233286={..._0x233286,..._0xe48886},(await Project_Security_Logs[_0x453f81(0x221)]({'user':_0x3158a5[_0x453f81(0x235)],'ip':_0x9bb308,'domain':_0x5bdc78,'appid':_0x3f3996})?await Project_Security_Logs['findOneAndUpdate']({'user':_0x3158a5[_0x453f81(0x235)],'ip':_0x9bb308,'domain':_0x5bdc78,'appid':_0x3f3996},{'$set':_0x233286}):await Project_Security_Logs['create']({'ip':_0x9bb308,'user':_0x3158a5[_0x453f81(0x235)],'domain':_0x5bdc78,'appid':_0x3f3996,..._0x233286}),_0x3ff71e[_0x453f81(0x220)](sendResponse,_0x333a58,0xc8,_0x3ff71e[_0x453f81(0x226)],'ok'));}catch(_0xd75e73){return errorHandler(_0x333a58,0x1f4,_0xd75e73[_0x453f81(0x210)]);}},'sensitivekeysinurl':async(_0x180b92,_0x5db30e)=>{const _0xe5093c=_0x3a2854,_0x52fbe3={'wQLKu':function(_0x485255,_0x52a042){return _0x485255>_0x52a042;},'lHqBA':_0xe5093c(0x1f9),'qsTwh':'All\x20provided\x20sensitive\x20keys\x20already\x20exist\x20in\x20the\x20URL.','INjHV':_0xe5093c(0x234),'PZidI':_0xe5093c(0x1f7),'ztVFI':function(_0x5c67d7,_0xa1f9d,_0x23332a){return _0x5c67d7(_0xa1f9d,_0x23332a);},'knlsV':_0xe5093c(0x204),'mWRbV':_0xe5093c(0x24b),'uGuVU':function(_0x42af25,_0xa8904e){return _0x42af25>_0xa8904e;},'cuoll':_0xe5093c(0x243),'WcXMG':_0xe5093c(0x248),'KehSB':function(_0xb25808,_0x4fa2e3){return _0xb25808===_0x4fa2e3;},'wWuct':_0xe5093c(0x22e),'meQXP':_0xe5093c(0x21e),'znNAc':function(_0x407b44,_0x120d8e,_0x332392){return _0x407b44(_0x120d8e,_0x332392);},'BPqjL':function(_0x1c9e50,_0x111a10){return _0x1c9e50>_0x111a10;},'MOJJl':_0xe5093c(0x236),'GKXFv':function(_0x310a0a,_0x476b19){return _0x310a0a===_0x476b19;},'tOkgp':function(_0x4ac535,_0x4d6b70){return _0x4ac535>_0x4d6b70;},'ibPly':_0xe5093c(0x233),'mfktf':function(_0x50f373,_0x3014f7){return _0x50f373===_0x3014f7;},'gNIhu':_0xe5093c(0x23b)};try{const {responseData:_0x4db5b4,url:_0x486708,query:_0x5d025c,domain:_0x584bc8,appid:_0x467252,RawBody:_0x2558e6}=_0x180b92[_0xe5093c(0x20c)];console[_0xe5093c(0x251)](_0x52fbe3[_0xe5093c(0x223)],_0x2558e6);const {_id:_0x33b8a3}=_0x180b92['user'],_0x4a6258=await _0x52fbe3[_0xe5093c(0x23e)](CheckPasswordKeyText,_0x4db5b4,passwordkeys);console[_0xe5093c(0x251)](_0x52fbe3[_0xe5093c(0x20a)],_0x4a6258);const _0x39b0ba=await PasswordValidateModel[_0xe5093c(0x221)]({'domain':_0x584bc8,'appid':_0x467252});async function _0x2150ba(_0x38d715,_0x42f69c,_0x1ffe17,_0x345e9f){const _0x432e9b=_0xe5093c;try{const _0x5a8640=await CrticalInformationInurl[_0x432e9b(0x221)]({'user':_0x33b8a3,'domain':_0x42f69c,'appid':_0x1ffe17,'type':_0x345e9f});if(_0x5a8640){const _0x39217e=_0x38d715['filter'](_0x51d7af=>!_0x5a8640[_0x432e9b(0x1fa)][_0x432e9b(0x224)](_0x51d7af));_0x52fbe3[_0x432e9b(0x202)](_0x39217e[_0x432e9b(0x1f1)],0x0)?(_0x5a8640['sensitivekeys'][_0x432e9b(0x1ff)](..._0x39217e),await _0x5a8640[_0x432e9b(0x23a)](),_0x5c1ba5=_0x52fbe3[_0x432e9b(0x216)]):_0x5c1ba5=_0x52fbe3['qsTwh'];}else await CrticalInformationInurl['create']({'user':_0x33b8a3,'domain':_0x42f69c,'url':_0x486708,'sensitivekeys':_0x38d715,'appid':_0x1ffe17,'type':_0x345e9f}),_0x5c1ba5=_0x432e9b(0x1f9);}catch(_0x5b11e3){console[_0x432e9b(0x21c)](_0x52fbe3[_0x432e9b(0x217)],_0x5b11e3),_0x5c1ba5=_0x432e9b(0x225);}}let _0x5c1ba5;if(!_0x39b0ba&&_0x4a6258['ispassword']?await PasswordValidateModel['create']({'domain':_0x584bc8,'HashedPassword':_0x4a6258['isHashedPassword'],'appid':_0x467252,'password':_0x4a6258['ispassword']}):_0x39b0ba&&_0x4a6258[_0xe5093c(0x214)]&&await PasswordValidateModel[_0xe5093c(0x1fd)]({'domain':_0x584bc8,'appid':_0x467252},{'$set':{'HashedPassword':_0x4a6258[_0xe5093c(0x25a)],'appid':_0x467252,'password':_0x4a6258['ispassword']}}),_0x5d025c){let _0x3d1e86=await _0x52fbe3[_0xe5093c(0x23e)](CheckAllDataIsEncrypted,_0x5d025c,sensitivedata);if(console['log'](_0x52fbe3[_0xe5093c(0x244)],_0x3d1e86),_0x52fbe3[_0xe5093c(0x202)](_0x3d1e86[_0xe5093c(0x1f1)],0x0)){let _0x218774=_0x3d1e86['filter'](_0x24f211=>!0x1===_0x24f211['encrypted']);_0x52fbe3[_0xe5093c(0x255)](_0x218774[_0xe5093c(0x1f1)],0x0)&&(await ServerDataInPlaintextModel[_0xe5093c(0x230)](_0x218774,{'ordered':!0x1})[_0xe5093c(0x259)](_0x46becc=>{}),_0x5c1ba5=_0x52fbe3[_0xe5093c(0x246)]);}const _0xa75339=await _0x52fbe3[_0xe5093c(0x23e)](checkForSensitiveInfoInBody,_0x5d025c,sensitivedata);console[_0xe5093c(0x251)](_0x52fbe3[_0xe5093c(0x203)],_0xa75339),_0x52fbe3['KehSB'](0x0,_0xa75339[_0xe5093c(0x1f1)])&&(_0x5c1ba5=_0x52fbe3[_0xe5093c(0x24d)]),_0x52fbe3['wQLKu'](_0xa75339[_0xe5093c(0x1f1)],0x0)&&await _0x2150ba(_0xa75339,_0x584bc8,_0x467252,_0x52fbe3[_0xe5093c(0x22a)]);}if(_0x2558e6){let _0x3abc5d=await _0x52fbe3[_0xe5093c(0x209)](CheckAllDataIsEncrypted,_0x2558e6,sensitivedata);if(console[_0xe5093c(0x251)](_0x52fbe3[_0xe5093c(0x244)],_0x3abc5d),_0x52fbe3[_0xe5093c(0x21f)](_0x3abc5d[_0xe5093c(0x1f1)],0x0)){let _0x3a052b=_0x3abc5d[_0xe5093c(0x237)](_0x260f28=>!_0x260f28[_0xe5093c(0x213)]);if(_0x52fbe3[_0xe5093c(0x255)](_0x3a052b['length'],0x0)){let _0x332a15=_0x3a052b['map'](_0x5a236a=>_0x5a236a[_0xe5093c(0x24e)]),_0x3cd8f6=await ServerDataInPlaintextModel[_0xe5093c(0x221)]({'domain':_0x584bc8,'appid':_0x467252});if(_0x3cd8f6){let _0x1b0d1c=_0x3cd8f6[_0xe5093c(0x24e)],_0x599c4a=Array[_0xe5093c(0x257)](new Set([..._0x1b0d1c,..._0x332a15]));await ServerDataInPlaintextModel[_0xe5093c(0x1fd)]({'domain':_0x584bc8,'appid':_0x467252},{'$set':{'key':_0x599c4a}});}else await ServerDataInPlaintextModel[_0xe5093c(0x23f)]({'domain':_0x584bc8,'appid':_0x467252,'key':_0x332a15});}}}if(_0x4db5b4){const _0x213261=await _0x52fbe3[_0xe5093c(0x209)](checkForSensitiveInfoInBody,_0x4db5b4,sensitivedata);console[_0xe5093c(0x251)](_0x52fbe3[_0xe5093c(0x203)],_0x213261,_0x52fbe3[_0xe5093c(0x207)],_0x4db5b4),_0x52fbe3[_0xe5093c(0x21b)](0x0,_0x213261[_0xe5093c(0x1f1)])&&(_0x5c1ba5=_0xe5093c(0x24c)),_0x52fbe3[_0xe5093c(0x1f2)](_0x213261[_0xe5093c(0x1f1)],0x0)&&await _0x2150ba(_0x213261,_0x584bc8,_0x467252,_0x52fbe3['ibPly']);}return _0x5db30e[_0xe5093c(0x1ef)](0xc8)[_0xe5093c(0x241)]({'success':!0x0,'message':_0x5c1ba5});}catch(_0x716d2d){return console[_0xe5093c(0x251)](_0x716d2d),_0x52fbe3[_0xe5093c(0x231)](0x2af8,_0x716d2d[_0xe5093c(0x22d)])?_0x5db30e['status'](0xc8)[_0xe5093c(0x241)]({'success':!0x0,'message':_0x52fbe3['gNIhu']}):_0x5db30e[_0xe5093c(0x1ef)](0x1f4)['json']({'error':_0xe5093c(0x23d)});}},'VpnValidation':async(_0x170d1f,_0x510abf)=>{const _0x18070c=_0x3a2854,_0x1df983={'EDZbY':function(_0x126d3a,_0x69a24f,_0x27fa2c,_0x55ce23){return _0x126d3a(_0x69a24f,_0x27fa2c,_0x55ce23);},'vwNuY':function(_0x301f39,_0x3a281f){return _0x301f39(_0x3a281f);}};let _0x16ec6b=_0x170d1f[_0x18070c(0x1f4)][_0x18070c(0x256)]||_0x170d1f[_0x18070c(0x208)][_0x18070c(0x21a)];return await VpnResponse(_0x16ec6b)['then'](_0x510abf)[_0x18070c(0x259)](_0x20c37a=>_0x20c37a)?_0x1df983['EDZbY'](errorHandler,_0x510abf,0x196,_0x18070c(0x1f3)+_0x16ec6b):_0x1df983[_0x18070c(0x24a)](sendResponse,_0x510abf);},'AuthValidation':async(_0x1c12cc,_0x58fbe5)=>{const _0x1cf850=_0x3a2854,_0x3fa0a6={'hiEKN':function(_0x531b6b,_0x3d8b41,_0x14ff02,_0x2f6f48){return _0x531b6b(_0x3d8b41,_0x14ff02,_0x2f6f48);},'ndvSC':function(_0x57f144,_0x11e32a,_0xa1b0c7,_0xe6f252){return _0x57f144(_0x11e32a,_0xa1b0c7,_0xe6f252);}};try{return _0x3fa0a6['hiEKN'](sendResponse,_0x58fbe5,0xc8,'Ok');}catch(_0x6479a6){return _0x3fa0a6['ndvSC'](errorHandler,_0x58fbe5,0x1f4,_0x6479a6[_0x1cf850(0x210)]);}}};function _0x1b92(){const _0x5996ca=['log','February','../../models/Security/SecurityMisconfiguration.model','../../models/PasswordVaildateModel','uGuVU','x-forwarded-for','from','../../models/User','catch','isHashedPassword','toLocaleTimeString','2243790WhJmzI','status','../../models/Project_Security_Logs','length','tOkgp','VPn\x20Detect\x20in\x20the\x20Ip\x20','headers','1878ZAocWl','user','RawBody','weLfK','New\x20sensitive\x20keys\x20added\x20to\x20the\x20URL.','sensitivekeys','xyFmR','November','updateOne','getDate','push','150299dQvFwV','124DEzvIO','wQLKu','WcXMG','passworddata','June','BxbBJ','MOJJl','socket','znNAc','knlsV','8RFWnRe','body','GjqwB','August','MoFDJ','message','April','Provide\x20Valid\x20APi\x20Key','encrypted','ispassword','March','lHqBA','INjHV','LXrFa','14nBGmLr','remoteAddress','GKXFv','error','../../utils/VpnChecker','url','BPqjL','iCtFR','findOne','../../utils/functions','PZidI','includes','An\x20error\x20occurred\x20while\x20processing\x20your\x20request.','wWZXZ','../../utils/errorHandler','HFCiy','4090VrgnLp','meQXP','TrAYQ','5972309NLCsxT','code','No\x20sensitive\x20key\x20found\x20in\x20the\x20query.','2291085oiTCmW','insertMany','mfktf','findOneAndUpdate','response','Error\x20creating\x20or\x20updating\x20data:','_id','responseData','filter','792132dFbWQI','../../utils/dataHandler','save','Sensitive\x20key\x20already\x20exists\x20in\x20the\x20URL.','SLXQa','Internal\x20Server\x20Error','ztVFI','create','May','json','October','Sensitive\x20data\x20is\x20not\x20encrypted\x20in\x20the\x20query.','mWRbV','getFullYear','cuoll','September','sensitivekey','July','vwNuY','isEncyptedData','No\x20sensitive\x20key\x20found\x20in\x20the\x20Data.','wWuct','key','January','46707EUmvZH'];_0x1b92=function(){return _0x5996ca;};return _0x1b92();}