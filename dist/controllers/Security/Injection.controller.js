const _0x18d280=_0x48d7;(function(_0x469ce4,_0x59a447){const _0x249934=_0x48d7,_0x57254b=_0x469ce4();while(!![]){try{const _0x1d85a0=-parseInt(_0x249934(0x1af))/0x1*(parseInt(_0x249934(0x1ea))/0x2)+parseInt(_0x249934(0x1b7))/0x3+parseInt(_0x249934(0x1d2))/0x4*(parseInt(_0x249934(0x19f))/0x5)+-parseInt(_0x249934(0x1a0))/0x6+-parseInt(_0x249934(0x1be))/0x7+-parseInt(_0x249934(0x1b4))/0x8+parseInt(_0x249934(0x190))/0x9;if(_0x1d85a0===_0x59a447)break;else _0x57254b['push'](_0x57254b['shift']());}catch(_0x5e659d){_0x57254b['push'](_0x57254b['shift']());}}}(_0x4919,0xaacc9));function _0x4919(){const _0x3e0330=['vQDjI','17KdXYlV','FTKJa','LONbp','log','push','7762496huTBKO','fXwPA','data\x20deleted\x20successfully','3087303qoTQrq','HLpkO','IFSUH','user','XSS','exports','ApIAz','1253917nZtqmh','xss-injection','ObjectId','gdAGX','ceil','OKmzD','zwvum','count','text/event-stream','aggregate','XWJlW','gOSSR','BAnUh','uJMFs','xZSmv','countDocuments','length','data:','query','now','160408GYpLuU','OUyDR','error','keep-alive','message','RuFaJ','UFfgj','XML-Injection','writeHead','data:\x20','../../utils/TestWithPlayWright/Sqlvulnurability','NIDvD','VXSHB','write','ACjCy','qKVjm','../../utils/dataHandler','slug','host','XML','cmd','forEach','data','end','88158nSBeUJ','Scanning\x20completed','://','get','data\x20fetch\x20successfully','GwSCh','mongoose','findOne','13986252jATbOI','Types','ZHOju','object','YeBFi','params','XAxym','findOneAndDelete','Scanning\x20started','qiJSM','VPN','Command\x20Line','Data\x20fetched\x20successfully','stringify','map','70uPJYQC','3277068lywOmD','../../models/Project_Security_Logs','plesae\x20enter\x20valid\x20id','rFGMw','jJIst','HTML','klCyu','EsjdW','_id','QoeOS','please\x20enter\x20valid\x20id','Remote-FiLe-Inclusion','/api/videostream/','osyhM'];_0x4919=function(){return _0x3e0330;};return _0x4919();}function _0x48d7(_0x5dbd5d,_0x2c1ff2){const _0x4919dc=_0x4919();return _0x48d7=function(_0x48d7d6,_0x446d16){_0x48d7d6=_0x48d7d6-0x18e;let _0x3d4360=_0x4919dc[_0x48d7d6];return _0x3d4360;},_0x48d7(_0x5dbd5d,_0x2c1ff2);}const {Project_Security_Logs:Project_Security_Logs}=require(_0x18d280(0x1a1)),{sendResponse:sendResponse}=require(_0x18d280(0x1e2)),{errorHandler:errorHandler}=require('../../utils/errorHandler'),getRandomColor=require('../../helpers/randomColorGenerator'),{default:mongoose}=require(_0x18d280(0x18e)),scanSQLvulnerability=require(_0x18d280(0x1dc)),getAllLogs=async(_0x466147,_0x206e0b)=>{const _0x1671d5=_0x18d280,_0x216bec={'ntJkf':function(_0x3ef14f,_0xad7f80){return _0x3ef14f(_0xad7f80);},'uCSuw':function(_0x3f34e9,_0x280551){return _0x3f34e9(_0x280551);},'qiJSM':function(_0x107e86,_0x590c36){return _0x107e86-_0x590c36;},'osyhM':function(_0x26df77,_0x22cebb,_0x1f309e,_0x5a2d91,_0x1f472a){return _0x26df77(_0x22cebb,_0x1f309e,_0x5a2d91,_0x1f472a);},'jJIst':_0x1671d5(0x1ee),'PpzVV':function(_0x3767db,_0x2a4ea7){return _0x3767db/_0x2a4ea7;},'klCyu':function(_0x571d38,_0x418fe2,_0xd8611d,_0xd6efbb){return _0x571d38(_0x418fe2,_0xd8611d,_0xd6efbb);}};try{const {page:_0x25b250,limit:_0x4866c0,question:_0x3e1b0c,..._0xaa6f37}=_0x466147['query'];let _0x4321cf={},_0x2696ba=Object['keys'](_0xaa6f37);for(let _0x1a7674 of _0x2696ba)_0xaa6f37[_0x1a7674]&&(_0x4321cf[_0x1a7674]=_0xaa6f37[_0x1a7674]);_0x4321cf[_0x1671d5(0x1ba)]=mongoose[_0x1671d5(0x191)][_0x1671d5(0x1c0)](_0x466147['user']['id']);const _0x529271=await Project_Security_Logs[_0x1671d5(0x1cd)](_0x4321cf),_0x3bb666=_0x529271>0xa&&_0x216bec['ntJkf'](parseInt,_0x25b250)||0x1,_0xac5038=_0x216bec['uCSuw'](parseInt,_0x4866c0)||0xa,_0x7c0fc6=[{'$match':_0x4321cf},{'$sort':{'createdAt':-0x1}},{'$skip':_0x216bec[_0x1671d5(0x199)](_0x3bb666,0x1)*_0xac5038},{'$limit':_0xac5038}],_0x1aef7e=await Project_Security_Logs[_0x1671d5(0x1c7)](_0x7c0fc6);return _0x216bec[_0x1671d5(0x1ad)](sendResponse,_0x206e0b,0xc8,_0x216bec[_0x1671d5(0x1a4)],{'data':_0x1aef7e,'totalCount':_0x529271,'currentPage':_0x3bb666,'totalPages':Math[_0x1671d5(0x1c2)](_0x216bec['PpzVV'](_0x529271,_0xac5038))});}catch(_0x211d55){return _0x216bec[_0x1671d5(0x1a6)](errorHandler,_0x206e0b,0x1f4,_0x211d55[_0x1671d5(0x1d6)]);}},getLogs=async(_0xed54c5,_0x40a35b)=>{const _0x3f720b=_0x18d280,_0x40855e={'VXSHB':'data\x20fetch\x20successfully','AZGSa':function(_0xce10f2,_0x248784,_0x42773a,_0x18a8e5){return _0xce10f2(_0x248784,_0x42773a,_0x18a8e5);},'gOSSR':_0x3f720b(0x1a2)};try{const _0x457b5b=_0xed54c5[_0x3f720b(0x195)]['ip'];if(_0x457b5b){const _0xcabda7=await Project_Security_Logs[_0x3f720b(0x18f)]({'ip':_0x457b5b});return sendResponse(_0x40a35b,0xc8,_0x40855e[_0x3f720b(0x1de)],_0xcabda7);}return _0x40855e['AZGSa'](sendResponse,_0x40a35b,0x194,_0x40855e[_0x3f720b(0x1c9)]);}catch(_0xfa5d95){return errorHandler(_0x40a35b,0x1f4,_0xfa5d95[_0x3f720b(0x1d6)]);}},getLogsCount=async(_0x51dc37,_0xe2795f)=>{const _0x2a2a54=_0x18d280,_0x273dc6={'XAxym':function(_0x3be71b,_0x25815b){return _0x3be71b!==_0x25815b;},'vQDjI':_0x2a2a54(0x19a),'HLpkO':function(_0x34dce0,_0x231fc5){return _0x34dce0!==_0x231fc5;},'fXwPA':_0x2a2a54(0x1ab),'BAnUh':_0x2a2a54(0x1e6),'RuFaJ':_0x2a2a54(0x19b),'fJklF':_0x2a2a54(0x1bb),'hOMtS':'html','zwvum':_0x2a2a54(0x1a5),'GwSCh':function(_0xfeb8a1,_0x68d10b){return _0xfeb8a1===_0x68d10b;},'gdAGX':_0x2a2a54(0x1d9),'LONbp':_0x2a2a54(0x1e5),'qKVjm':function(_0x44956c,_0x1bdee7){return _0x44956c(_0x1bdee7);},'aLkJB':function(_0x122137,_0x4ed178){return _0x122137!==_0x4ed178;},'NIDvD':function(_0x193381,_0x1b5aa5){return _0x193381!==_0x1b5aa5;},'EsjdW':function(_0x30cfe8,_0x465cd0){return _0x30cfe8(_0x465cd0);},'UFfgj':_0x2a2a54(0x193),'ZHOju':'$type','XWJlW':function(_0x2e74a4,_0x51886){return _0x2e74a4>_0x51886;},'OUyDR':function(_0x58f244,_0x44a3b5,_0x42a1c6,_0x21dd8e,_0x3b4201){return _0x58f244(_0x44a3b5,_0x42a1c6,_0x21dd8e,_0x3b4201);},'ApIAz':_0x2a2a54(0x19c),'FTKJa':function(_0x3c6a02,_0x50882f,_0x48a112,_0x29db01){return _0x3c6a02(_0x50882f,_0x48a112,_0x29db01);}};try{let _0x4c9440=[];console[_0x2a2a54(0x1b2)](_0x273dc6[_0x2a2a54(0x1d8)],_0x51dc37[_0x2a2a54(0x1ba)]);let _0x58fa3d=[],_0x395dee={};const _0x4c7ec1=require('../../utils/Injectionstype.json')[_0x2a2a54(0x1e8)][_0x2a2a54(0x19e)](_0x3818d8=>_0x3818d8[_0x2a2a54(0x1e3)]);return _0x4c9440=await Project_Security_Logs[_0x2a2a54(0x1c7)]([{'$match':{'user':new mongoose['Types'][(_0x2a2a54(0x1c0))](_0x51dc37[_0x2a2a54(0x1ba)]['id']),'domain':_0x51dc37[_0x2a2a54(0x1d0)]['domain']}},{'$group':{'_id':_0x273dc6[_0x2a2a54(0x192)],'count':{'$sum':0x1}}}]),_0x273dc6[_0x2a2a54(0x1c8)](_0x4c9440[_0x2a2a54(0x1ce)],0x0)?(_0x4c9440['forEach'](_0x160dc0=>{const _0x2f6b5f=_0x2a2a54;_0x395dee[_0x160dc0[_0x2f6b5f(0x1a8)]]=_0x160dc0[_0x2f6b5f(0x1c5)];}),_0x4c7ec1[_0x2a2a54(0x1e7)](_0x2eec22=>{const _0x354f05=_0x2a2a54;_0x273dc6[_0x354f05(0x196)](_0x273dc6[_0x354f05(0x1ae)],_0x2eec22)&&_0x273dc6[_0x354f05(0x1b8)](_0x273dc6[_0x354f05(0x1b5)],_0x2eec22)&&_0x58fa3d[_0x354f05(0x1b3)]({'name':_0x273dc6[_0x354f05(0x1ca)]===_0x2eec22?_0x273dc6[_0x354f05(0x1d7)]:_0x354f05(0x1bf)===_0x2eec22?_0x273dc6['fJklF']:_0x273dc6['hOMtS']===_0x2eec22?_0x273dc6[_0x354f05(0x1c4)]:_0x273dc6[_0x354f05(0x1ef)](_0x273dc6['gdAGX'],_0x2eec22)?_0x273dc6['LONbp']:_0x2eec22,'value':_0x395dee[_0x2eec22]||0x0,'color':_0x273dc6[_0x354f05(0x1e1)](getRandomColor,_0x2eec22)});})):_0x4c7ec1[_0x2a2a54(0x1e7)](_0x55d9af=>{const _0x3bf983=_0x2a2a54;_0x273dc6['aLkJB'](_0x273dc6[_0x3bf983(0x1ae)],_0x55d9af)&&_0x273dc6[_0x3bf983(0x1dd)](_0x273dc6[_0x3bf983(0x1b5)],_0x55d9af)&&_0x58fa3d[_0x3bf983(0x1b3)]({'name':_0x273dc6[_0x3bf983(0x1ef)](_0x273dc6[_0x3bf983(0x1c1)],_0x55d9af)?_0x273dc6[_0x3bf983(0x1b1)]:_0x55d9af,'value':0x0,'color':_0x273dc6[_0x3bf983(0x1a7)](getRandomColor,_0x55d9af)});}),_0x273dc6[_0x2a2a54(0x1d3)](sendResponse,_0xe2795f,0xc8,_0x273dc6[_0x2a2a54(0x1bd)],_0x58fa3d);}catch(_0x48e664){return console[_0x2a2a54(0x1b2)](_0x48e664),_0x273dc6[_0x2a2a54(0x1b0)](errorHandler,_0xe2795f,0x1f4,_0x48e664[_0x2a2a54(0x1d6)]);}},deleteLogs=async(_0x1362f7,_0x4863b0)=>{const _0x3bafed=_0x18d280,_0x1c046b={'IFSUH':function(_0x3ae3ac,_0x526db0,_0x111ef0,_0x175255,_0x19d96b){return _0x3ae3ac(_0x526db0,_0x111ef0,_0x175255,_0x19d96b);},'rFGMw':_0x3bafed(0x1b6),'QoeOS':_0x3bafed(0x1aa)};try{const _0x32fb3f=_0x1362f7[_0x3bafed(0x195)]['ip'],_0x34f7b9=await Project_Security_Logs[_0x3bafed(0x197)]({'ip':_0x32fb3f});return _0x34f7b9?_0x1c046b[_0x3bafed(0x1b9)](sendResponse,_0x4863b0,0xc8,_0x1c046b[_0x3bafed(0x1a3)],_0x34f7b9):_0x1c046b['IFSUH'](sendResponse,_0x4863b0,0x194,_0x1c046b[_0x3bafed(0x1a9)],_0x34f7b9);}catch(_0x36ed2b){return errorHandler(_0x4863b0,0x1f4,_0x36ed2b[_0x3bafed(0x1d6)]);}},testVulnurability=async(_0x838af8,_0x1aa20a)=>{const _0xc797ca=_0x18d280,_0x12cc59={'ACjCy':_0xc797ca(0x1c6),'uJMFs':_0xc797ca(0x1d5),'OKmzD':'no-cache','aqPYl':function(_0x27e25a,_0x31150c,_0x694d83){return _0x27e25a(_0x31150c,_0x694d83);},'xZSmv':function(_0x8aa740,_0x5975db,_0x578153,_0x346a67,_0x26e3b0){return _0x8aa740(_0x5975db,_0x578153,_0x346a67,_0x26e3b0);},'DKwVW':_0xc797ca(0x1eb),'YeBFi':'Error\x20occurred\x20while\x20scanning:'};try{const _0x3039c2=_0x838af8[_0xc797ca(0x1d0)]['domain'],_0x399273={'Content-Type':_0x12cc59[_0xc797ca(0x1e0)],'Connection':_0x12cc59[_0xc797ca(0x1cb)],'Cache-Control':_0x12cc59[_0xc797ca(0x1c3)]},_0x4743ac=_0x838af8['protocol']+_0xc797ca(0x1ec)+_0x838af8[_0xc797ca(0x1ed)](_0xc797ca(0x1e4))+_0xc797ca(0x1ac);_0x1aa20a[_0xc797ca(0x1da)](0xc8,_0x399273);const _0x544dae=(_0x3b8e4b,_0x48d7b9=_0x48d7b9)=>{const _0x41931a=_0xc797ca;_0x48d7b9[_0x41931a(0x1df)](_0x41931a(0x1cf)+JSON['stringify'](_0x3b8e4b)+'\x20\x0a\x0a');};_0x12cc59['aqPYl'](_0x544dae,{'message':_0xc797ca(0x198),'complete':!0x1,'time':Date[_0xc797ca(0x1d1)]()},_0x1aa20a);const _0x47abd4=await _0x12cc59[_0xc797ca(0x1cc)](scanSQLvulnerability,'https://'+_0x3039c2,_0x1aa20a,_0x544dae,_0x4743ac);console[_0xc797ca(0x1b2)]('Scanning\x20completed:',_0x47abd4),_0x544dae({'message':_0x12cc59['DKwVW'],'time':Date['now'](),'complete':!0x0},_0x1aa20a),_0x1aa20a[_0xc797ca(0x1e9)]();}catch(_0x8ec48c){console[_0xc797ca(0x1d4)](_0x12cc59[_0xc797ca(0x194)],_0x8ec48c),_0x1aa20a[_0xc797ca(0x1df)](_0xc797ca(0x1db)+JSON[_0xc797ca(0x19d)]({'message':_0x8ec48c[_0xc797ca(0x1d6)],'complete':!0x0})+'\x20\x0a\x0a'),_0x1aa20a[_0xc797ca(0x1e9)]();}},Allogs={'getAllLogs':getAllLogs,'getLogs':getLogs,'deleteLogs':deleteLogs,'getLogsCount':getLogsCount,'testVulnurability':testVulnurability};module[_0x18d280(0x1bc)]=Allogs;