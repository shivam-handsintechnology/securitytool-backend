if(window.SecurityTool={validateSecurityConfiguration:()=>{let e=window.appid,t=window.SecurityValidatConfiguration;return!!e&&(!!t&&(0!=Object.keys(t).length&&(!!(e&&t&&Object.keys(t).length>0)||void 0)))},getAlllocalStorageData:async()=>{const e={};for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t),o=localStorage.getItem(n);e[n]=o}return 0===Object.keys(e).length?null:e},getAllSessionStorageData:async()=>{const e={};for(let t=0;t<sessionStorage.length;t++){const n=sessionStorage.key(t),o=sessionStorage.getItem(n);e[n]=o}return 0===Object.keys(e).length?null:e},sendToApi:async(e,t,n)=>{try{let o={data:t,appid:window.appid,subdomain:window.location.hostname};n&&(o.sessionStoragedata=n),await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then((e=>{e.ok?console.log("Data sent successfully"):console.error("Failed to send data")})).catch((e=>{console.error("Failed to send data",e)}))}catch(e){console.log("Error in sending data to API",e)}},CallSensitivedataLocalStorage:async()=>{let e=await window.SecurityTool.getAlllocalStorageData(),t=await window.SecurityTool.getAllSessionStorageData();if(null!==e){let n="https://securitytool.handsintechnology.in/api/client/protection";window.SecurityTool.sendToApi(n,e,t).then((e=>e)).catch((e=>e))}},hasDuplicateParameters:e=>{const t=new Set;for(const n in e){if(t.has(n))return!0;t.add(n)}return!1},hasSqlInjection:function(e){if(new RegExp("(%27)|(--)|([0-9]=[0-9])|([0-9] and [0-9]=[0-9])|([0-9] AND [0-9])|(or [0-9]=[0-9])|(OR [0-9]=[0-9])|(%23)|(#)","i").test(e))return!0;if(new RegExp("((%3D)|(=))[^\n]*((%27)|(')|(--)|(%3B)|(;))","i").test(e))return!0;if(new RegExp("((%3D)|(=))[^\n]*((%27)|(')|(--)|(%3B)|(;))?[^\n]*((%27)|(')|(--)|(%3B)|(;))[^\n]*((%3D)|(=))","i").test(e))return!0;if(new RegExp("(%3B)|(;)[^\n]*sleep[^\n]*(d+)[^\n]*","i").test(e))return!0;if(new RegExp("((%3D)|(=))[^\n]*[^s]*(%27)|(')|(--)|(%3B)|(;)","i").test(e))return!0;if(new RegExp("w*((%27)|('))((%6F)|o|(%4F))((%72)|r|(%52))","i").test(e))return!0;if(new RegExp("((%27)|('))union","i").test(e))return!0;return!!new RegExp("\b((select|delete|insert|update|drop|create|alter|order by|and)\b.*)","i").test(e)},hasCommandLineInjection:function(e){return!!new RegExp(/(?:\/\*\*\/|\/\*.*?\*\/|\/\/.*?(?=\r?\n)|< !--.*?- ->|(?:&lt;|<)!\-\-.*?\-\-(?:&gt;|>)|\b(?:cat\s*?\/?|grep|system\(\s*?['"`]{0,1}|`\s*?\w+|[|&;`\(\)\s]\s*?\/?(?:bin\/\w+|usr\/\w+|n?cat\s+[\\|;&\(\)\/\w]+?)\s*?[\?&;|`]|(?:;|\?\?|\\\\n|\\\\r\s*\n?)\s*?[\\\;&\|`\(\)\s]?\/\w+\/\w+|['"`&\|`][\s\r\n]|[\?\&][\s\r\n]))|(?:npm\s+(?:install|i|update|uninstall|--version|--help|--force))|(?:yarn\s+(?:add|remove|upgrade|--version|--help|--force))|(?:node\s+[\w\.-]+\.js)|(?:rm\s+-\w*\s*[\w\/\.-]*)|(?:mv\s+[\w\/\.-]+\s+[\w\/\.-]+)|(?:cp\s+[\w\/\.-]+\s+[\w\/\.-]+)|(?:mkdir\s+[\w\/\.-]+)|(?:touch\s+[\w\/\.-]+)|(?:chmod\s+[\w\/\.-]+)|(?:chown\s+[\w\/\.-]+)|(?:ps\s+\w*)|(?:top)|(?:kill\s+-\w*\s*\d+)|(?:pkill\s+\w+)|(?:\(\)\s*\{\s*:;\s*\}\s*;\s*\/\s*\w+(?:\/\s*\w+)?\s*-\w+\s*['"`](?:.*?['"`\?\&]|.*?))/i).test(e)},hasHTMLnjection:function(e){return!!new RegExp(/<(\"[^\"]*\"|'[^']*'|[^'\">])*>/,"g").test(e)},cssInjectionRegex:/<style[^>]*>|<\/style>|url\s*\((['"]?)javascript:\w*\(\1\)\1\)/gi,hasCSSInjection:function(e){return!!this.cssInjectionRegex.test(e)},xssRegex:new RegExp('(<script\\b[^>]*>[\\s\\S]*?<\\/script>|<svg\\b|<object\\b|<embed\\b|<iframe\\b|<link\\b|<video\\b|<audio\\b|<body\\b|<frame\\b|<meta\\b|<title\\b|<head\\b|<html\\b|<base\\b|<blink\\b|<marquee\\b|<expression\\b|\\b(?:alert|confirm|console|dialog|prompt|req|response|showModalDialog|write(?:ln)?|XSS|valueOf)?\\s*?[(\'""/] | (?:\\b|[^\\\\])(?:\\\\\\\\)*/?\\s*(?:--|>|<|%3C|%3E|%00|&#x0[0-9a-f]);?)',"gi"),hasXSSInjection:function(e){return!!this.xssRegex.test(e)},InjectionChecker:function(e){let t=!1,n=!1,o=!1,i=!1,s=!1,r=!1;const a=JSON.stringify(e)?.toLowerCase();return a.includes("<iframe")&&(s=!0),!0===this.hasCSSInjection(a)&&(r=!0),!0===this.hasXSSInjection(a)&&(n=!0),!0===this.hasHTMLnjection(a)&&(o=!0),!0===this.hasCommandLineInjection(a)&&(i=!0),!0===this.hasSqlInjection(a)&&(t=!0),{containsSql:t,validateXss:n,validatehtml:o,containCommand:i,containiframetag:s,validateCss:r}},detectXMLInjection:function(e){const t=new RegExp("<!\\[CDATA\\[.*\\]\\]>","g"),n=new RegExp("<!ENTITY.*>","g");try{return t.test(e)?{error:"XML Injection detected in Cdata"}:n.test(e)?{error:"XML Injection detected in ExternalEntity"}:e.includes("<iframe")?{error:"Iframe tag detected"}:!0===this.hasCSSInjection(e)?{error:"CSS Injection detected"}:!0===this.hasXSSInjection(e)?{error:"XSS Injection detected"}:!0===this.hasHTMLInjection(e)?{error:"HTML Injection detected"}:!0===this.hasCommandLineInjection(e)?{error:"Command Injection detected"}:!0===this.hasSqlInjection(e)?{error:"SQL Injection detected"}:null}catch(e){return console.error("Error during XML injection detection:",e),{error:"Error during XML injection detection"}}},CreateuserDetails:async function(e){try{const t={page:window.location.pathname,referurl:window.location.href,type:e};await window.SecurityTool.sendToApi("https://securitytool.handsintechnology.in/api/client/createuserdetailsfromclient",t).then((e=>e)).catch((e=>e))}catch(e){console.log("error in malicious data create ",e)}}},"undefined"!=typeof window&&!window.CustomXMLHttpRequest){class e extends XMLHttpRequest{constructor(){super();const e=window.SecurityValidatConfiguration,t=this.open;this.open=function(e,n,o,i,s){this._method=e,this._url=n,console.log(`Making request to ${n}`),t.apply(this,arguments)};const n=this.send;this.send=function(t){console.log("XHR called with method:",this._method),console.log("XHR payload:",t);try{if(!window.SecurityTool.validateSecurityConfiguration())throw console.log("Provide valid data according to Docs"),new Error("Provide valid data according to Docs");const n=new URLSearchParams(window.location.search),o=Object.fromEntries(n.entries());console.log("queries",o);let i={};(()=>{try{i=JSON.parse(t),i={body:t,...o}}catch(e){console.log(e),i={body:t,...o}}})();const s=this.getRequestHeader("Content-Type");if(console.log("Request Content-Type:",s),"application/xml"===s){if(window.SecurityTool.detectXMLInjection(i)&&e.xml)return alert("Xml  detected"),void window.SecurityTool.CreateuserDetails("css")}else{const t=window.SecurityTool.InjectionChecker(i);let n=window.SecurityTool.hasDuplicateParameters(o);if(t.validateCss&&e.css)return alert("CSS detected"),void window.SecurityTool.CreateuserDetails("css");if(t.containCommand&&e.commandline)return alert("Command detected"),void window.SecurityTool.CreateuserDetails("commandline");if(t.validateXss&&e.xss)return alert("XSS detected"),void window.SecurityTool.CreateuserDetails("xss");if(t.containiframetag&&e.iframe)return alert("Iframe detected"),void window.SecurityTool.CreateuserDetails("iframe");if(t.validatehtml&&e.html)return alert("HTML detected"),void window.SecurityTool.CreateuserDetails("html");if(t.containsSql&&e.Sql)return alert("SQL detected"),void window.SecurityTool.CreateuserDetails("sql");if(n)return alert("Http parameter pollution detected"),void window.SecurityTool.CreateuserDetails("httpParameterPollution")}}catch(e){console.log(e)}const o=this;this.addEventListener("readystatechange",(function(){if(4===o.readyState){console.log("XHR response data:",o.responseText);let e=window.SecurityTool.validateSecurityConfiguration();setTimeout((async()=>{if(!e)throw new Error("Provide valid data according to Docs");await window.SecurityTool.CallSensitivedataLocalStorage().then((e=>e)).catch((e=>e))}),500)}})),n.apply(this,arguments)}}}window.XMLHttpRequest=e,window.CustomXMLHttpRequest=e}