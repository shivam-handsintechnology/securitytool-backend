const _0x271c94=_0x558d;(function(_0x39865e,_0x4fcaed){const _0x3f980f=_0x558d,_0x12094b=_0x39865e();while(!![]){try{const _0x195774=parseInt(_0x3f980f(0x1f7))/0x1*(-parseInt(_0x3f980f(0x213))/0x2)+parseInt(_0x3f980f(0x1fe))/0x3*(-parseInt(_0x3f980f(0x22f))/0x4)+-parseInt(_0x3f980f(0x21d))/0x5+-parseInt(_0x3f980f(0x24a))/0x6+parseInt(_0x3f980f(0x253))/0x7+-parseInt(_0x3f980f(0x1f8))/0x8+parseInt(_0x3f980f(0x23d))/0x9;if(_0x195774===_0x4fcaed)break;else _0x12094b['push'](_0x12094b['shift']());}catch(_0x398387){_0x12094b['push'](_0x12094b['shift']());}}}(_0x1c88,0xc626b));function _0x1c88(){const _0x5f072c=['count','ObjectId','IrnyJ','forEach','lWgXq','get','Scanning\x20completed','HTML','iLhHR','VPN','vcbli','text/event-stream','user','findOne','3558cAonMN','lWcMs','mongoose','XSS','../../models/Project_Security_Logs','aggregate','https://','drXCQ','writeHead','owNgr','4570885UNIbZK','dleAV','../../helpers/randomColorGenerator','nclmH','SCeYK','keys','Error\x20occurred\x20while\x20scanning:','exports','XML','error','length','KVQPT','Types','XML-Injection','now','stringify','data\x20fetch\x20successfully','data\x20deleted\x20successfully','192876HlNElR','Scanning\x20started','object','countDocuments','write','data','domain','protocol','wkObf','host','QUYRZ','xUnyW','map','Command\x20Line','35756055EmWSFH','Data\x20fetched\x20successfully','xwFQP','Scanning\x20completed:','kvXon','yMxTR','pcoDN','Bfnkf','slug','NJVTU','dyaBi','_id','juiHs','1026654BtHAUq','lYZAf','EwAEl','end','heVuS','ruFmu','fMTTq','push','ceil','1684424xxmBmz','Remote-FiLe-Inclusion','fgLeq','keep-alive','data:','please\x20enter\x20valid\x20id','$type','\x20\x0a\x0a','query','6fxNwnw','6489208aAYBHo','cmd','LiZiK','log','../../utils/errorHandler','GfQVy','93lTXcrp','data:\x20','message','eNDWh','../../utils/dataHandler','plesae\x20enter\x20valid\x20id','params'];_0x1c88=function(){return _0x5f072c;};return _0x1c88();}const {Project_Security_Logs:Project_Security_Logs}=require(_0x271c94(0x217)),{sendResponse:sendResponse}=require(_0x271c94(0x202)),{errorHandler:errorHandler}=require(_0x271c94(0x1fc)),getRandomColor=require(_0x271c94(0x21f)),{default:mongoose}=require(_0x271c94(0x215)),scanSQLvulnerability=require('../../utils/TestWithPlayWright/Sqlvulnurability'),getAllLogs=async(_0x13ae94,_0x23fa25)=>{const _0x670e8c=_0x271c94,_0x407b18={'QUYRZ':function(_0x1ca9e9,_0x227964){return _0x1ca9e9>_0x227964;},'fgLeq':function(_0x3ec023,_0x4890b1){return _0x3ec023(_0x4890b1);},'fMTTq':function(_0x3ba4c7,_0x1d5207){return _0x3ba4c7*_0x1d5207;},'SCeYK':function(_0x57f61f,_0x42e0b2){return _0x57f61f-_0x42e0b2;},'rXyuX':'data\x20fetch\x20successfully','KRdkk':function(_0x192d8c,_0x6d9216){return _0x192d8c/_0x6d9216;},'juiHs':function(_0x8a1eaa,_0x790126,_0x32fdfa,_0x19d31d){return _0x8a1eaa(_0x790126,_0x32fdfa,_0x19d31d);}};try{const {page:_0x1962a1,limit:_0xfc0e88,question:_0x28f427,..._0x24ebcc}=_0x13ae94[_0x670e8c(0x1f6)];let _0x44bfc6={},_0x4c6e4c=Object[_0x670e8c(0x222)](_0x24ebcc);for(let _0x4989e3 of _0x4c6e4c)_0x24ebcc[_0x4989e3]&&(_0x44bfc6[_0x4989e3]=_0x24ebcc[_0x4989e3]);_0x44bfc6['user']=mongoose['Types'][_0x670e8c(0x206)](_0x13ae94[_0x670e8c(0x211)]['id']);const _0x36a336=await Project_Security_Logs[_0x670e8c(0x232)](_0x44bfc6),_0x3cfeaa=_0x407b18[_0x670e8c(0x239)](_0x36a336,0xa)&&_0x407b18[_0x670e8c(0x255)](parseInt,_0x1962a1)||0x1,_0xc96c1d=_0x407b18[_0x670e8c(0x255)](parseInt,_0xfc0e88)||0xa,_0x577af3=[{'$match':_0x44bfc6},{'$sort':{'createdAt':-0x1}},{'$skip':_0x407b18[_0x670e8c(0x250)](_0x407b18[_0x670e8c(0x221)](_0x3cfeaa,0x1),_0xc96c1d)},{'$limit':_0xc96c1d}],_0x492a02=await Project_Security_Logs[_0x670e8c(0x218)](_0x577af3);return sendResponse(_0x23fa25,0xc8,_0x407b18['rXyuX'],{'data':_0x492a02,'totalCount':_0x36a336,'currentPage':_0x3cfeaa,'totalPages':Math[_0x670e8c(0x252)](_0x407b18['KRdkk'](_0x36a336,_0xc96c1d))});}catch(_0x5d51a1){return _0x407b18[_0x670e8c(0x249)](errorHandler,_0x23fa25,0x1f4,_0x5d51a1[_0x670e8c(0x200)]);}},getLogs=async(_0x14d3a2,_0x5f1432)=>{const _0x280261=_0x271c94,_0x41ac60={'xwFQP':function(_0x29ee13,_0x4a3741,_0x209e11,_0x7e22c9,_0x1be792){return _0x29ee13(_0x4a3741,_0x209e11,_0x7e22c9,_0x1be792);},'ruFmu':_0x280261(0x22d),'wkObf':_0x280261(0x203),'dyaBi':function(_0x1f6276,_0x1cbf81,_0x45ad9b,_0x3e71bc){return _0x1f6276(_0x1cbf81,_0x45ad9b,_0x3e71bc);}};try{const _0x3b93b4=_0x14d3a2[_0x280261(0x204)]['ip'];if(_0x3b93b4){const _0x2b852b=await Project_Security_Logs[_0x280261(0x212)]({'ip':_0x3b93b4});return _0x41ac60[_0x280261(0x23f)](sendResponse,_0x5f1432,0xc8,_0x41ac60[_0x280261(0x24f)],_0x2b852b);}return sendResponse(_0x5f1432,0x194,_0x41ac60[_0x280261(0x237)]);}catch(_0x571d08){return _0x41ac60[_0x280261(0x247)](errorHandler,_0x5f1432,0x1f4,_0x571d08['message']);}},getLogsCount=async(_0xeedad9,_0x5a7d43)=>{const _0x4c138b=_0x271c94,_0x1a95a5={'drXCQ':function(_0x35bc0b,_0x149e03){return _0x35bc0b!==_0x149e03;},'vcbli':_0x4c138b(0x20e),'xpPgM':_0x4c138b(0x254),'yMxTR':_0x4c138b(0x1f9),'KVQPT':function(_0xa83493,_0x4b77cf){return _0xa83493===_0x4b77cf;},'Bfnkf':'xss-injection','Gytob':_0x4c138b(0x216),'lWcMs':function(_0x196699,_0x371f64){return _0x196699(_0x371f64);},'NJVTU':function(_0x32f75d,_0x23ca4f){return _0x32f75d!==_0x23ca4f;},'owNgr':function(_0x5dd3e8,_0x2dc769){return _0x5dd3e8!==_0x2dc769;},'kvXon':_0x4c138b(0x22a),'lYZAf':_0x4c138b(0x225),'EwAEl':_0x4c138b(0x231),'iLhHR':'../../utils/Injectionstype.json','LiZiK':_0x4c138b(0x1f4),'lWgXq':function(_0x4cb095,_0x5c5a0c,_0x35694d,_0x504c83,_0x55258b){return _0x4cb095(_0x5c5a0c,_0x35694d,_0x504c83,_0x55258b);},'dleAV':_0x4c138b(0x23e),'xUnyW':function(_0x15bf84,_0x295bd8,_0x33009a,_0x47f2a8){return _0x15bf84(_0x295bd8,_0x33009a,_0x47f2a8);}};try{let _0x22b14a=[];console[_0x4c138b(0x1fb)](_0x1a95a5[_0x4c138b(0x24c)],_0xeedad9[_0x4c138b(0x211)]);let _0x474d19=[],_0x395a61={};const _0x50efed=require(_0x1a95a5[_0x4c138b(0x20d)])[_0x4c138b(0x234)][_0x4c138b(0x23b)](_0x543897=>_0x543897[_0x4c138b(0x245)]);return _0x22b14a=await Project_Security_Logs[_0x4c138b(0x218)]([{'$match':{'user':new mongoose[(_0x4c138b(0x229))][(_0x4c138b(0x206))](_0xeedad9[_0x4c138b(0x211)]['id']),'domain':_0xeedad9['query'][_0x4c138b(0x235)]}},{'$group':{'_id':_0x1a95a5[_0x4c138b(0x1fa)],'count':{'$sum':0x1}}}]),_0x22b14a[_0x4c138b(0x227)]>0x0?(_0x22b14a[_0x4c138b(0x208)](_0x4dda2c=>{const _0x10cfce=_0x4c138b;_0x395a61[_0x4dda2c[_0x10cfce(0x248)]]=_0x4dda2c[_0x10cfce(0x205)];}),_0x50efed['forEach'](_0x526016=>{const _0x150a8f=_0x4c138b;_0x1a95a5[_0x150a8f(0x21a)](_0x1a95a5[_0x150a8f(0x20f)],_0x526016)&&_0x1a95a5['xpPgM']!==_0x526016&&_0x474d19['push']({'name':_0x1a95a5[_0x150a8f(0x242)]===_0x526016?_0x150a8f(0x23c):_0x1a95a5[_0x150a8f(0x228)](_0x1a95a5[_0x150a8f(0x244)],_0x526016)?_0x1a95a5['Gytob']:_0x1a95a5[_0x150a8f(0x228)]('html',_0x526016)?_0x150a8f(0x20c):_0x150a8f(0x22a)===_0x526016?'XML':_0x526016,'value':_0x395a61[_0x526016]||0x0,'color':_0x1a95a5[_0x150a8f(0x214)](getRandomColor,_0x526016)});})):_0x50efed[_0x4c138b(0x208)](_0x5ff109=>{const _0x274629=_0x4c138b;_0x1a95a5[_0x274629(0x246)](_0x274629(0x20e),_0x5ff109)&&_0x1a95a5[_0x274629(0x21c)](_0x274629(0x254),_0x5ff109)&&_0x474d19[_0x274629(0x251)]({'name':_0x1a95a5[_0x274629(0x241)]===_0x5ff109?_0x1a95a5[_0x274629(0x24b)]:_0x5ff109,'value':0x0,'color':_0x1a95a5['lWcMs'](getRandomColor,_0x5ff109)});}),_0x1a95a5[_0x4c138b(0x209)](sendResponse,_0x5a7d43,0xc8,_0x1a95a5[_0x4c138b(0x21e)],_0x474d19);}catch(_0xca046b){return console[_0x4c138b(0x1fb)](_0xca046b),_0x1a95a5[_0x4c138b(0x23a)](errorHandler,_0x5a7d43,0x1f4,_0xca046b['message']);}},deleteLogs=async(_0xb4d3e6,_0x48ae6f)=>{const _0x2c85d6=_0x271c94,_0x4ffa1f={'WuBZk':function(_0x3b6921,_0x32cc41,_0x3e9dca,_0x5334e7,_0x309c73){return _0x3b6921(_0x32cc41,_0x3e9dca,_0x5334e7,_0x309c73);},'Fhbpm':function(_0x4a95e5,_0x5b6ab6,_0x3d03de,_0x232110,_0x185cc7){return _0x4a95e5(_0x5b6ab6,_0x3d03de,_0x232110,_0x185cc7);},'QAAtX':_0x2c85d6(0x1f3),'eNDWh':function(_0x40b617,_0x558673,_0x3e11e1,_0x1e5ca7){return _0x40b617(_0x558673,_0x3e11e1,_0x1e5ca7);}};try{const _0x1e0ad0=_0xb4d3e6['params']['ip'],_0x30f9b1=await Project_Security_Logs['findOneAndDelete']({'ip':_0x1e0ad0});return _0x30f9b1?_0x4ffa1f['WuBZk'](sendResponse,_0x48ae6f,0xc8,_0x2c85d6(0x22e),_0x30f9b1):_0x4ffa1f['Fhbpm'](sendResponse,_0x48ae6f,0x194,_0x4ffa1f['QAAtX'],_0x30f9b1);}catch(_0x513600){return _0x4ffa1f[_0x2c85d6(0x201)](errorHandler,_0x48ae6f,0x1f4,_0x513600[_0x2c85d6(0x200)]);}},testVulnurability=async(_0x1f9f8f,_0x5354ef)=>{const _0x161704=_0x271c94,_0x443028={'gijkU':_0x161704(0x210),'pcoDN':'no-cache','IrnyJ':function(_0x23cb56,_0x196192,_0x194079){return _0x23cb56(_0x196192,_0x194079);},'GfQVy':_0x161704(0x230),'nclmH':_0x161704(0x240),'heVuS':_0x161704(0x223)};try{const _0x511b90=_0x1f9f8f[_0x161704(0x1f6)][_0x161704(0x235)],_0x379821={'Content-Type':_0x443028['gijkU'],'Connection':_0x161704(0x1f1),'Cache-Control':_0x443028[_0x161704(0x243)]},_0x5c1368=_0x1f9f8f[_0x161704(0x236)]+'://'+_0x1f9f8f[_0x161704(0x20a)](_0x161704(0x238))+'/api/videostream/';_0x5354ef[_0x161704(0x21b)](0xc8,_0x379821);const _0x4dfda6=(_0x20f7f5,_0x52de17=_0x52de17)=>{const _0x5c0db3=_0x161704;_0x52de17['write'](_0x5c0db3(0x1f2)+JSON[_0x5c0db3(0x22c)](_0x20f7f5)+_0x5c0db3(0x1f5));};_0x443028[_0x161704(0x207)](_0x4dfda6,{'message':_0x443028[_0x161704(0x1fd)],'complete':!0x1,'time':Date[_0x161704(0x22b)]()},_0x5354ef);const _0x5ad085=await scanSQLvulnerability(_0x161704(0x219)+_0x511b90,_0x5354ef,_0x4dfda6,_0x5c1368);console[_0x161704(0x1fb)](_0x443028[_0x161704(0x220)],_0x5ad085),_0x443028[_0x161704(0x207)](_0x4dfda6,{'message':_0x161704(0x20b),'time':Date[_0x161704(0x22b)](),'complete':!0x0},_0x5354ef),_0x5354ef['end']();}catch(_0x436186){console[_0x161704(0x226)](_0x443028[_0x161704(0x24e)],_0x436186),_0x5354ef[_0x161704(0x233)](_0x161704(0x1ff)+JSON[_0x161704(0x22c)]({'message':_0x436186[_0x161704(0x200)],'complete':!0x0})+_0x161704(0x1f5)),_0x5354ef[_0x161704(0x24d)]();}},Allogs={'getAllLogs':getAllLogs,'getLogs':getLogs,'deleteLogs':deleteLogs,'getLogsCount':getLogsCount,'testVulnurability':testVulnurability};function _0x558d(_0x3176a8,_0x1af3b7){const _0x1c88ce=_0x1c88();return _0x558d=function(_0x558d05,_0x56b1a8){_0x558d05=_0x558d05-0x1f1;let _0x1d005a=_0x1c88ce[_0x558d05];return _0x1d005a;},_0x558d(_0x3176a8,_0x1af3b7);}module[_0x271c94(0x224)]=Allogs;