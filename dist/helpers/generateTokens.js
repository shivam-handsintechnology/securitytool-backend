const _0x527e64=_0x51ae;function _0x51ae(_0x5cfc0f,_0x3b8a72){const _0x332d63=_0x332d();return _0x51ae=function(_0x51aed8,_0x7f3716){_0x51aed8=_0x51aed8-0x7c;let _0x34d455=_0x332d63[_0x51aed8];return _0x34d455;},_0x51ae(_0x5cfc0f,_0x3b8a72);}(function(_0x28218d,_0x13993e){const _0x5f4462=_0x51ae,_0x2dc772=_0x28218d();while(!![]){try{const _0x4da087=parseInt(_0x5f4462(0x86))/0x1+-parseInt(_0x5f4462(0x94))/0x2*(-parseInt(_0x5f4462(0x91))/0x3)+parseInt(_0x5f4462(0x80))/0x4+parseInt(_0x5f4462(0x83))/0x5+parseInt(_0x5f4462(0x7d))/0x6*(parseInt(_0x5f4462(0x90))/0x7)+parseInt(_0x5f4462(0x8c))/0x8*(parseInt(_0x5f4462(0x8a))/0x9)+-parseInt(_0x5f4462(0x93))/0xa;if(_0x4da087===_0x13993e)break;else _0x2dc772['push'](_0x2dc772['shift']());}catch(_0x3f446a){_0x2dc772['push'](_0x2dc772['shift']());}}}(_0x332d,0xbe384));const jwt=require(_0x527e64(0x84)),UserToken=require(_0x527e64(0x89));exports[_0x527e64(0x85)]=async _0x3b2d64=>{const _0x43cfc3=_0x527e64,_0xa5d56e={'CQtKY':_0x43cfc3(0x7c),'kKzrh':_0x43cfc3(0x7f)};try{const _0x555c25={'_id':_0x3b2d64['_id'],'roles':_0x3b2d64[_0x43cfc3(0x87)]},_0x568731=jwt[_0x43cfc3(0x92)](_0x555c25,process[_0x43cfc3(0x8f)][_0x43cfc3(0x82)],{'expiresIn':_0xa5d56e[_0x43cfc3(0x8d)]}),_0x58d0ca=jwt[_0x43cfc3(0x92)](_0x555c25,process[_0x43cfc3(0x8f)][_0x43cfc3(0x8b)],{'expiresIn':_0xa5d56e[_0x43cfc3(0x88)]}),_0x530f3c=await UserToken['findOne']({'userId':_0x3b2d64['_id']});return _0x530f3c&&await _0x530f3c[_0x43cfc3(0x8e)](),await new UserToken({'userId':_0x3b2d64['_id'],'token':_0x58d0ca})['save'](),Promise[_0x43cfc3(0x7e)]({'accessToken':_0x568731,'refreshToken':_0x58d0ca});}catch(_0x3d5950){return Promise[_0x43cfc3(0x81)](_0x3d5950);}};function _0x332d(){const _0x2cbe4c=['remove','env','11529mZOriW','227991OPtlno','sign','26834920uRBSor','8cZYBmN','14m','1236swQRug','resolve','30d','3005336bliISY','reject','ACCESS_TOKEN_PRIVATE_KEY','3812820xwQAKA','jsonwebtoken','generateTokens','676198fRKasH','userType','kKzrh','../models/UserToken','198nNZaVK','REFRESH_TOKEN_PRIVATE_KEY','228824qaLlPk','CQtKY'];_0x332d=function(){return _0x2cbe4c;};return _0x332d();}