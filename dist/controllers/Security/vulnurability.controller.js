const _0x4c20d3=_0xdf01;(function(_0x3f7ae0,_0x30b77d){const _0x55b890=_0xdf01,_0x3cd035=_0x3f7ae0();while(!![]){try{const _0x3dc444=-parseInt(_0x55b890(0x1d9))/0x1*(-parseInt(_0x55b890(0x1c1))/0x2)+parseInt(_0x55b890(0x1ce))/0x3+parseInt(_0x55b890(0x1c7))/0x4*(parseInt(_0x55b890(0x1b6))/0x5)+-parseInt(_0x55b890(0x1c8))/0x6+-parseInt(_0x55b890(0x1b3))/0x7*(parseInt(_0x55b890(0x1d3))/0x8)+parseInt(_0x55b890(0x17f))/0x9*(-parseInt(_0x55b890(0x1a6))/0xa)+-parseInt(_0x55b890(0x18a))/0xb*(-parseInt(_0x55b890(0x17c))/0xc);if(_0x3dc444===_0x30b77d)break;else _0x3cd035['push'](_0x3cd035['shift']());}catch(_0x203c72){_0x3cd035['push'](_0x3cd035['shift']());}}}(_0x5a97,0x40bdd));function _0xdf01(_0x3c0f95,_0x33fb8b){const _0x5a9795=_0x5a97();return _0xdf01=function(_0xdf01f0,_0x4d41bf){_0xdf01f0=_0xdf01f0-0x17b;let _0x5e1752=_0x5a9795[_0xdf01f0];return _0x5e1752;},_0xdf01(_0x3c0f95,_0x33fb8b);}function _0x5a97(){const _0x4b9518=['code','../../models/User','Sensitive\x20data\x20is\x20not\x20encrypted\x20in\x20the\x20query.','gxCdw','user','kpcHt','body','findOne','438118tviRFM','json','insertMany','cNDXf','PmKjj','key','308ieQwer','298980ckYulR','November','March','TVXig','Internal\x20Server\x20Error','vOesb','5112QEzrHU','eVicK','getFullYear','GRzva','socket','24uQjNOL','New\x20sensitive\x20keys\x20added\x20to\x20the\x20URL.','_id','June','response','October','1yqbBTi','../../utils/VpnChecker','DRBaN','August','gncxf','12KhyJrf','error','September','135nHRiKV','fetch','hbTeZ','hOUWV','January','url','isHashedPassword','from','hmLdc','headers','responseData','5819572ByOPJx','ZoRLd','encrypted','RawBody','status','sensitivekey','tuJlf','lYeEC','../../models/PasswordVaildateModel','length','No\x20sensitive\x20key\x20found\x20in\x20the\x20query.','gQozw','Rqtsi','kQKyc','getDate','includes','kEYSe','sensitivekeys','July','DAnIf','message','push','isEncyptedData','filter','then','May','No\x20sensitive\x20key\x20found\x20in\x20the\x20Data.','qJQgn','180200DaxNWj','ispassword','February','remoteAddress','updateOne','save','../../utils/functions','gVrJh','dAwZv','findOneAndUpdate','eAkIE','dUUoN','user-agent','384202EXSUgF','ANVxb','log','10oCCnVO','create','x-forwarded-for'];_0x5a97=function(){return _0x4b9518;};return _0x5a97();}const {Project_Security_Logs:Project_Security_Logs}=require('../../models/Project_Security_Logs'),{CrticalInformationInurl:CrticalInformationInurl}=require('../../models/sensitivekeywordsModel'),{checkForSensitiveInfoInBody:checkForSensitiveInfoInBody,CheckPasswordKeyText:CheckPasswordKeyText,CheckAllDataIsEncrypted:CheckAllDataIsEncrypted}=require(_0x4c20d3(0x1ac)),{sensitivedata:sensitivedata,passwordkeys:passwordkeys}=require('../../sensitive/availableapikeys'),{sendResponse:sendResponse}=require('../../utils/dataHandler'),{errorHandler:errorHandler}=require('../../utils/errorHandler'),{PasswordValidateModel:PasswordValidateModel}=require(_0x4c20d3(0x192)),{ServerDataInPlaintextModel:ServerDataInPlaintextModel}=require('../../models/Security/SecurityMisconfiguration.model'),User=require(_0x4c20d3(0x1ba)),{VpnResponse:VpnResponse}=require(_0x4c20d3(0x1da));module['exports']={'createuserdetails':async(_0x4c7591,_0x172df5)=>{const _0x5e4a45=_0x4c20d3,_0x3484e4={'goRUe':function(_0x3adead,_0x4f3581,_0x4018a1,_0xf2baa9,_0x48524e){return _0x3adead(_0x4f3581,_0x4018a1,_0xf2baa9,_0x48524e);},'TVXig':function(_0x469729,_0x50b279,_0x13d1bf,_0x4e0420){return _0x469729(_0x50b279,_0x13d1bf,_0x4e0420);}};try{let {UserRawData:_0x3e251d,domain:_0x2d47f8,appid:_0x2c6231}=_0x4c7591[_0x5e4a45(0x1bf)];return await Project_Security_Logs[_0x5e4a45(0x1c0)]({'user':_0x4c7591[_0x5e4a45(0x1bd)][_0x5e4a45(0x1d5)],'ip':_0x3e251d['ip'],'domain':_0x2d47f8,'appid':_0x2c6231})?await Project_Security_Logs[_0x5e4a45(0x1af)]({'user':_0x4c7591[_0x5e4a45(0x1bd)][_0x5e4a45(0x1d5)],'ip':_0x3e251d['ip'],'domain':_0x2d47f8,'appid':_0x2c6231},{'$set':_0x3e251d}):await Project_Security_Logs['create']({'user':_0x4c7591[_0x5e4a45(0x1bd)][_0x5e4a45(0x1d5)],'domain':_0x2d47f8,'appid':_0x2c6231,..._0x3e251d}),_0x3484e4['goRUe'](sendResponse,_0x172df5,0xc8,'fetch','ok');}catch(_0x5f1e06){return _0x3484e4[_0x5e4a45(0x1cb)](errorHandler,_0x172df5,0x1f4,_0x5f1e06[_0x5e4a45(0x19e)]);}},'createuserdetailsfromclient':async(_0x295b2f,_0x36871d)=>{const _0x33d47c=_0x4c20d3,_0x169f80={'ZNmjX':_0x33d47c(0x183),'nmJlA':_0x33d47c(0x1a8),'hmLdc':_0x33d47c(0x1ca),'mRRtm':'April','voKsB':_0x33d47c(0x1a3),'kpcHt':_0x33d47c(0x19c),'cNDXf':_0x33d47c(0x1dc),'gxCdw':_0x33d47c(0x17e),'OKISx':_0x33d47c(0x1c9),'gQozw':'December','kEYSe':_0x33d47c(0x1b8),'eAkIE':function(_0x2d5930,_0x20be9c,_0x254249,_0x5216a2){return _0x2d5930(_0x20be9c,_0x254249,_0x5216a2);},'kQKyc':function(_0x19a68c,_0x43d2f8){return _0x19a68c+_0x43d2f8;},'vOesb':function(_0x2f787b,_0x55c2d4,_0x1bf3c6,_0x3e56b6,_0x597a12){return _0x2f787b(_0x55c2d4,_0x1bf3c6,_0x3e56b6,_0x597a12);},'QFBst':_0x33d47c(0x180)};try{const _0x468207=[_0x169f80['ZNmjX'],_0x169f80['nmJlA'],_0x169f80[_0x33d47c(0x187)],_0x169f80['mRRtm'],_0x169f80['voKsB'],_0x33d47c(0x1d6),_0x169f80[_0x33d47c(0x1be)],_0x169f80[_0x33d47c(0x1c4)],_0x169f80[_0x33d47c(0x1bc)],_0x33d47c(0x1d8),_0x169f80['OKISx'],_0x169f80[_0x33d47c(0x195)]],_0x12461c=new Date();let {data:_0x1661fa,hostname:_0x445441,appid:_0xd64362}=_0x295b2f[_0x33d47c(0x1bf)],_0x564126=_0x295b2f[_0x33d47c(0x188)][_0x169f80[_0x33d47c(0x19a)]]||_0x295b2f[_0x33d47c(0x1d2)][_0x33d47c(0x1a9)];const _0x59fba7=_0x295b2f[_0x33d47c(0x188)][_0x33d47c(0x1b2)];let _0x2b5ebf=await User['findOne']({'appid':_0xd64362});if(!_0x2b5ebf)return _0x169f80[_0x33d47c(0x1b0)](errorHandler,_0x36871d,0x190,'Provide\x20Valid\x20APi\x20Key');let _0xdfcbba={'useragent':_0x59fba7,'ip':_0x564126,'date':_0x169f80[_0x33d47c(0x197)](_0x169f80[_0x33d47c(0x197)](_0x169f80[_0x33d47c(0x197)](_0x12461c[_0x33d47c(0x198)](),'\x20'),_0x468207[_0x12461c['getMonth']()])+'\x20',_0x12461c[_0x33d47c(0x1d0)]()),'time':_0x12461c['toLocaleTimeString']()};return _0x1661fa={..._0x1661fa,..._0xdfcbba},(await Project_Security_Logs[_0x33d47c(0x1c0)]({'user':_0x2b5ebf['_id'],'ip':_0x564126,'domain':_0x445441,'appid':_0xd64362})?await Project_Security_Logs[_0x33d47c(0x1af)]({'user':_0x2b5ebf[_0x33d47c(0x1d5)],'ip':_0x564126,'domain':_0x445441,'appid':_0xd64362},{'$set':_0x1661fa}):await Project_Security_Logs['create']({'ip':_0x564126,'user':_0x2b5ebf[_0x33d47c(0x1d5)],'domain':_0x445441,'appid':_0xd64362,..._0x1661fa}),_0x169f80[_0x33d47c(0x1cd)](sendResponse,_0x36871d,0xc8,_0x169f80['QFBst'],'ok'));}catch(_0x3a0a43){return _0x169f80[_0x33d47c(0x1b0)](errorHandler,_0x36871d,0x1f4,_0x3a0a43[_0x33d47c(0x19e)]);}},'sensitivekeysinurl':async(_0x3413d7,_0x25e651)=>{const _0xb35c2f=_0x4c20d3,_0x3fb04f={'eVicK':function(_0x21311b,_0x4c3da5){return _0x21311b>_0x4c3da5;},'hoiah':_0xb35c2f(0x1d4),'GRzva':'All\x20provided\x20sensitive\x20keys\x20already\x20exist\x20in\x20the\x20URL.','tuJlf':'Error\x20creating\x20or\x20updating\x20data:','gVrJh':function(_0x319b84,_0x403f1e,_0x177308){return _0x319b84(_0x403f1e,_0x177308);},'DRBaN':function(_0x4ff23a,_0x155536,_0x374899){return _0x4ff23a(_0x155536,_0x374899);},'hbTeZ':_0xb35c2f(0x1a0),'dAwZv':function(_0x550644,_0x1f26df){return _0x550644>_0x1f26df;},'uQcDf':_0xb35c2f(0x1bb),'qJQgn':_0xb35c2f(0x18f),'dUUoN':function(_0x15a9aa,_0x8435b6){return _0x15a9aa===_0x8435b6;},'UuzEI':_0xb35c2f(0x194),'hOUWV':function(_0xee7a49,_0x465fcd){return _0xee7a49>_0x465fcd;},'gncxf':function(_0x569da7,_0x1e452d,_0x27bf5b,_0x36a0c5,_0xd45063){return _0x569da7(_0x1e452d,_0x27bf5b,_0x36a0c5,_0xd45063);},'DAnIf':_0xb35c2f(0x184),'WbPKb':function(_0x433616,_0xf8768b){return _0x433616>_0xf8768b;},'PmKjj':_0xb35c2f(0x189),'zyeYP':function(_0x31842f,_0x23efa6){return _0x31842f>_0x23efa6;},'lYeEC':_0xb35c2f(0x1d7)};try{const {responseData:_0x9660d3,url:_0x74037f,query:_0x3b5dc3,domain:_0x5f02cc,appid:_0x43a830,RawBody:_0x5e4bcb}=_0x3413d7['body'];console[_0xb35c2f(0x1b5)](_0xb35c2f(0x18d),_0x5e4bcb);const {_id:_0x4c4b15}=_0x3413d7[_0xb35c2f(0x1bd)],_0x56345e=await _0x3fb04f[_0xb35c2f(0x1ad)](CheckPasswordKeyText,_0x9660d3,passwordkeys);console[_0xb35c2f(0x1b5)]('passworddata',_0x56345e);const _0x1e0e96=await PasswordValidateModel['findOne']({'domain':_0x5f02cc,'appid':_0x43a830});async function _0x477a9f(_0x2a6d80,_0xbcb8f3,_0x481038,_0x5c86f6){const _0x557245=_0xb35c2f;try{const _0x1393e2=await CrticalInformationInurl[_0x557245(0x1c0)]({'user':_0x4c4b15,'domain':_0xbcb8f3,'appid':_0x481038,'type':_0x5c86f6});if(_0x1393e2){const _0xec2d2f=_0x2a6d80[_0x557245(0x1a1)](_0x29f5b6=>!_0x1393e2[_0x557245(0x19b)][_0x557245(0x199)](_0x29f5b6));_0x3fb04f[_0x557245(0x1cf)](_0xec2d2f[_0x557245(0x193)],0x0)?(_0x1393e2[_0x557245(0x19b)][_0x557245(0x19f)](..._0xec2d2f),await _0x1393e2[_0x557245(0x1ab)](),_0x17f0d3=_0x3fb04f['hoiah']):_0x17f0d3=_0x3fb04f[_0x557245(0x1d1)];}else await CrticalInformationInurl['create']({'user':_0x4c4b15,'domain':_0xbcb8f3,'url':_0x74037f,'sensitivekeys':_0x2a6d80,'appid':_0x481038,'type':_0x5c86f6}),_0x17f0d3=_0x557245(0x1d4);}catch(_0x54d522){console[_0x557245(0x17d)](_0x3fb04f[_0x557245(0x190)],_0x54d522),_0x17f0d3='An\x20error\x20occurred\x20while\x20processing\x20your\x20request.';}}let _0x17f0d3;if(!_0x1e0e96&&_0x56345e[_0xb35c2f(0x1a7)]?await PasswordValidateModel[_0xb35c2f(0x1b7)]({'domain':_0x5f02cc,'HashedPassword':_0x56345e[_0xb35c2f(0x185)],'appid':_0x43a830,'password':_0x56345e[_0xb35c2f(0x1a7)]}):_0x1e0e96&&_0x56345e[_0xb35c2f(0x1a7)]&&await PasswordValidateModel[_0xb35c2f(0x1aa)]({'domain':_0x5f02cc,'appid':_0x43a830},{'$set':{'HashedPassword':_0x56345e[_0xb35c2f(0x185)],'appid':_0x43a830,'password':_0x56345e['ispassword']}}),_0x3b5dc3){let _0x404be5=await _0x3fb04f['DRBaN'](CheckAllDataIsEncrypted,_0x3b5dc3,sensitivedata);if(console[_0xb35c2f(0x1b5)](_0x3fb04f[_0xb35c2f(0x181)],_0x404be5),_0x3fb04f[_0xb35c2f(0x1ae)](_0x404be5['length'],0x0)){let _0xe3d93b=_0x404be5[_0xb35c2f(0x1a1)](_0x80ea6b=>!0x1===_0x80ea6b[_0xb35c2f(0x18c)]);_0x3fb04f[_0xb35c2f(0x1cf)](_0xe3d93b[_0xb35c2f(0x193)],0x0)&&(await ServerDataInPlaintextModel[_0xb35c2f(0x1c3)](_0xe3d93b,{'ordered':!0x1})['catch'](_0x222e94=>{}),_0x17f0d3=_0x3fb04f['uQcDf']);}const _0x590ab9=await _0x3fb04f[_0xb35c2f(0x1db)](checkForSensitiveInfoInBody,_0x3b5dc3,sensitivedata);console[_0xb35c2f(0x1b5)](_0x3fb04f[_0xb35c2f(0x1a5)],_0x590ab9),_0x3fb04f[_0xb35c2f(0x1b1)](0x0,_0x590ab9[_0xb35c2f(0x193)])&&(_0x17f0d3=_0x3fb04f['UuzEI']),_0x3fb04f[_0xb35c2f(0x182)](_0x590ab9[_0xb35c2f(0x193)],0x0)&&await _0x3fb04f[_0xb35c2f(0x17b)](_0x477a9f,_0x590ab9,_0x5f02cc,_0x43a830,_0x3fb04f[_0xb35c2f(0x19d)]);}if(_0x5e4bcb){let _0x3432d4=await _0x3fb04f[_0xb35c2f(0x1db)](CheckAllDataIsEncrypted,_0x5e4bcb,sensitivedata);if(console[_0xb35c2f(0x1b5)](_0x3fb04f[_0xb35c2f(0x181)],_0x3432d4),_0x3432d4['length']>0x0){let _0x429428=_0x3432d4[_0xb35c2f(0x1a1)](_0x2dafa9=>!_0x2dafa9[_0xb35c2f(0x18c)]);if(_0x3fb04f['WbPKb'](_0x429428[_0xb35c2f(0x193)],0x0)){let _0x215a24=_0x429428['map'](_0x1c950d=>_0x1c950d[_0xb35c2f(0x1c6)]),_0x37888b=await ServerDataInPlaintextModel[_0xb35c2f(0x1c0)]({'domain':_0x5f02cc,'appid':_0x43a830});if(_0x37888b){let _0x5e2567=_0x37888b[_0xb35c2f(0x1c6)],_0x2895e5=Array[_0xb35c2f(0x186)](new Set([..._0x5e2567,..._0x215a24]));await ServerDataInPlaintextModel['updateOne']({'domain':_0x5f02cc,'appid':_0x43a830},{'$set':{'key':_0x2895e5}});}else await ServerDataInPlaintextModel[_0xb35c2f(0x1b7)]({'domain':_0x5f02cc,'appid':_0x43a830,'key':_0x215a24});}}}if(_0x9660d3){const _0x57161f=await _0x3fb04f['DRBaN'](checkForSensitiveInfoInBody,_0x9660d3,sensitivedata);console[_0xb35c2f(0x1b5)](_0x3fb04f[_0xb35c2f(0x1a5)],_0x57161f,_0x3fb04f[_0xb35c2f(0x1c5)],_0x9660d3),_0x3fb04f[_0xb35c2f(0x1b1)](0x0,_0x57161f['length'])&&(_0x17f0d3=_0xb35c2f(0x1a4)),_0x3fb04f['zyeYP'](_0x57161f[_0xb35c2f(0x193)],0x0)&&await _0x477a9f(_0x57161f,_0x5f02cc,_0x43a830,_0x3fb04f[_0xb35c2f(0x191)]);}return _0x25e651['status'](0xc8)[_0xb35c2f(0x1c2)]({'success':!0x0,'message':_0x17f0d3});}catch(_0x3fb521){return console['log'](_0x3fb521),0x2af8===_0x3fb521[_0xb35c2f(0x1b9)]?_0x25e651['status'](0xc8)[_0xb35c2f(0x1c2)]({'success':!0x0,'message':'Sensitive\x20key\x20already\x20exists\x20in\x20the\x20URL.'}):_0x25e651[_0xb35c2f(0x18e)](0x1f4)[_0xb35c2f(0x1c2)]({'error':_0xb35c2f(0x1cc)});}},'VpnValidation':async(_0xf52b8c,_0x13f234)=>{const _0x24e6b2=_0x4c20d3,_0x223b07={'Rqtsi':_0x24e6b2(0x1b8),'ANVxb':function(_0x26389,_0x5b5564){return _0x26389(_0x5b5564);}};let _0xbcb9f5=_0xf52b8c['headers'][_0x223b07[_0x24e6b2(0x196)]]||_0xf52b8c['socket'][_0x24e6b2(0x1a9)];return await _0x223b07[_0x24e6b2(0x1b4)](VpnResponse,_0xbcb9f5)[_0x24e6b2(0x1a2)](_0x13f234)['catch'](_0x5c8e23=>_0x5c8e23)?errorHandler(_0x13f234,0x196,'VPn\x20Detect\x20in\x20the\x20Ip\x20'+_0xbcb9f5):_0x223b07[_0x24e6b2(0x1b4)](sendResponse,_0x13f234);},'AuthValidation':async(_0x5167cf,_0x2b3a92)=>{const _0x5815a9=_0x4c20d3,_0xfc16a9={'ZoRLd':function(_0x49a7e6,_0xcc8887,_0x35b6b1,_0xb1f9f2){return _0x49a7e6(_0xcc8887,_0x35b6b1,_0xb1f9f2);}};try{return sendResponse(_0x2b3a92,0xc8,'Ok');}catch(_0x1776d5){return _0xfc16a9[_0x5815a9(0x18b)](errorHandler,_0x2b3a92,0x1f4,_0x1776d5[_0x5815a9(0x19e)]);}}};